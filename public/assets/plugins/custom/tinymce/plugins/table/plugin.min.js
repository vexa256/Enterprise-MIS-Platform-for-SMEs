!function(){"use strict";var n=function(n){return function(t){return r=typeof(e=t),(null===e?"null":"object"==r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===n;var e,r}},t=function(n){return function(t){return typeof t===n}},e=n("string"),r=n("object"),o=n("array"),u=t("boolean"),i=(void 0,function(n){return undefined===n}),c=function(n){return!(null===(t=n)||void 0===t);var t},a=t("function"),l=t("number"),f=function(){},s=function(n){return function(){return n}},d=function(n){return n};function m(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var p,g,h,v=function(n){return function(t){return!n(t)}},b=s(!1),w=s(!0),y=function(){return x},x=(p=function(n){return n.isNone()},{fold:function(n,t){return n()},is:b,isSome:b,isNone:w,getOr:h=function(n){return n},getOrThunk:g=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:s(null),getOrUndefined:s(void 0),or:h,orThunk:g,map:y,each:f,bind:y,exists:b,forall:w,filter:y,equals:p,equals_:p,toArray:function(){return[]},toString:s("none()")}),C=function(n){var t=s(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:w,isNone:b,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return C(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:x},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(b,(function(t){return e(n,t)}))}};return o},S={some:C,none:y,from:function(n){return null==n?x:C(n)}},T=Array.prototype.slice,R=Array.prototype.indexOf,D=Array.prototype.push,O=function(n,t){return e=n,r=t,-1<R.call(e,r);var e,r},A=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return!0;return!1},k=function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},B=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var u=n[o];r[o]=t(u,o)}return r},E=function(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)},P=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var u=n[r];t(u,r)&&e.push(u)}return e},I=function(n,t,e){return function(n,t){for(var e=n.length-1;0<=e;e--)t(n[e])}(n,(function(n){e=t(e,n)})),e},M=function(n,t,e){return E(n,(function(n){e=t(e,n)})),e},N=function(n,t){return function(n,t,e){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(t(u,r))return S.some(u);if(e(u,r))break}return S.none()}(n,t,b)},W=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return S.some(e);return S.none()},L=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!o(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);D.apply(t,n[e])}return t},z=function(n,t){return L(B(n,t))},_=function(n,t){for(var e=0,r=n.length;e<r;++e)if(!0!==t(n[e],e))return!1;return!0},j=function(n,t){for(var e={},r=0,o=n.length;r<o;r++){var u=n[r];e[String(u)]=t(u,r)}return e},F=function(n){return[n]},H=function(n,t){return 0<=t&&t<n.length?S.some(n[t]):S.none()},q=function(n){return H(n,0)},V=function(n){return H(n,n.length-1)},U=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return S.none()},K=function(){return(K=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function $(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var u=arguments[t],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}var G,X=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},Y=function(){return J(0,0)},J=function(n,t){return{major:n,minor:t}},Q=function(n,t){var e=String(t).toLowerCase();return 0===n.length?Y():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}}(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return J(r(1),r(2))}(n,e)},Z=Y,nn=function(n,t){var e=String(t).toLowerCase();return N(n,(function(n){return n.search(e)}))},tn=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},en=function(n,t){return-1!==n.indexOf(t)},rn=function(n,t){return tn(n,t,0)},on=function(n,t){return tn(n,t,n.length-t.length)},un=(G=/^\s+|\s+$/g,function(n){return n.replace(G,"")}),cn=function(n){return 0<n.length},an=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ln=function(n){return function(t){return en(t,n)}},fn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return en(n,"edge/")&&en(n,"chrome")&&en(n,"safari")&&en(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,an],search:function(n){return en(n,"chrome")&&!en(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return en(n,"msie")||en(n,"trident")}},{name:"Opera",versionRegexes:[an,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ln("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ln("firefox")},{name:"Safari",versionRegexes:[an,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(en(n,"safari")||en(n,"mobile/"))&&en(n,"applewebkit")}}],sn=[{name:"Windows",search:ln("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return en(n,"iphone")||en(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ln("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ln("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ln("linux"),versionRegexes:[]},{name:"Solaris",search:ln("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ln("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ln("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],dn={browsers:s(fn),oses:s(sn)},mn="Firefox",pn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(mn),isSafari:r("Safari")}},gn=function(){return pn({current:void 0,version:Z()})},hn=pn,vn=(s("Edge"),s("Chrome"),s("IE"),s("Opera"),s(mn),s("Safari"),"Windows"),bn="Android",wn="Solaris",yn="FreeBSD",xn="ChromeOS",Cn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(vn),isiOS:r("iOS"),isAndroid:r(bn),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(wn),isFreeBSD:r(yn),isChromeOS:r(xn)}},Sn=function(){return Cn({current:void 0,version:Z()})},Tn=Cn,Rn=(s(vn),s("iOS"),s(bn),s("Linux"),s("OSX"),s(wn),s(yn),s(xn),function(n,t){var e,r,o,u,i,c,a,l,f,d,m,p,g=dn.browsers(),h=dn.oses(),v=function(n,t){return nn(n,t).map((function(n){var e=Q(n.versionRegexes,t);return{current:n.name,version:e}}))}(g,n).fold(gn,hn),b=function(n,t){return nn(n,t).map((function(n){var e=Q(n.versionRegexes,t);return{current:n.name,version:e}}))}(h,n).fold(Sn,Tn);return{browser:v,os:b,deviceType:(r=v,o=n,u=t,i=(e=b).isiOS()&&!0===/ipad/i.test(o),c=e.isiOS()&&!i,a=e.isiOS()||e.isAndroid(),l=a||u("(pointer:coarse)"),f=i||!c&&a&&u("(min-device-width:768px)"),d=c||a&&!f,m=r.isSafari()&&e.isiOS()&&!1===/safari/i.test(o),p=!d&&!f&&!m,{isiPad:s(i),isiPhone:s(c),isTablet:s(f),isPhone:s(d),isTouch:s(l),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:s(m),isDesktop:s(p)})}}),Dn=function(n){return window.matchMedia(n).matches},On=X((function(){return Rn(navigator.userAgent,Dn)})),An=function(){return On()},kn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},Bn={fromHtml:function(n,t){var e=(t||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return kn(e.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n);return kn(e)},fromText:function(n,t){var e=(t||document).createTextNode(n);return kn(e)},fromDom:kn,fromPoint:function(n,t,e){return S.from(n.dom.elementFromPoint(t,e)).map(kn)}},En=function(n,t){var e=n.dom;if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Pn=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},In=function(n,t){return n.dom===t.dom},Mn=function(n,t){return An().browser.isIE()?function(n,t){return e=n.dom,r=t.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(r)&o);var e,r,o}(n,t):(e=t,(r=n.dom)!==(o=e.dom)&&r.contains(o));var e,r,o},Nn=En,Wn=Object.keys,Ln=Object.hasOwnProperty,zn=function(n,t){for(var e=Wn(n),r=0,o=e.length;r<o;r++){var u=e[r];t(n[u],u)}},_n=function(n,t){return jn(n,(function(n,e){return{k:e,v:t(n,e)}}))},jn=function(n,t){var e={};return zn(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},Fn=function(n,t){var e,r,o,u,i={};return e=t,u=i,r=function(n,t){u[t]=n},o=f,zn(n,(function(n,t){(e(n,t)?r:o)(n,t)})),i},Hn=function(n,t){var e=[];return zn(n,(function(n,r){e.push(t(n,r))})),e},qn=function(n){return Wn(n).length},Vn=function(n,t){return Un(n,t)?S.from(n[t]):S.none()},Un=function(n,t){return Ln.call(n,t)},Kn=function(n,t){return Un(n,t)&&void 0!==n[t]&&null!==n[t]},$n=["tfoot","thead","tbody","colgroup"],Gn=function(n,t,e){return{element:n,rowspan:t,colspan:e}},Xn=function(n,t,e){return{element:n,cells:t,section:e}},Yn=function(n,t,e){return{element:n,isNew:t,isLocked:e}},Jn=function(n,t){return{cells:n,section:t}},Qn=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),Zn=function(n){return n.dom.nodeType},nt=function(n){return function(t){return Zn(t)===n}},tt=function(n){return 8===Zn(n)||"#comment"===Qn(n)},et=nt(1),rt=nt(3),ot=nt(9),ut=nt(11),it=function(n){return function(t){return et(t)&&Qn(t)===n}},ct=function(n){return Bn.fromDom(n.dom.ownerDocument)},at=function(n){return ot(n)?n:ct(n)},lt=function(n){return S.from(n.dom.parentNode).map(Bn.fromDom)},ft=function(n,t){for(var e=a(t)?t:b,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Bn.fromDom(u);if(o.push(i),!0===e(i))break;r=u}return o},st=function(n){return S.from(n.dom.previousSibling).map(Bn.fromDom)},dt=function(n){return S.from(n.dom.nextSibling).map(Bn.fromDom)},mt=function(n){return B(n.dom.childNodes,Bn.fromDom)},pt=function(n,t){var e=n.dom.childNodes;return S.from(e[t]).map(Bn.fromDom)},gt=a(Element.prototype.attachShadow)&&a(Node.prototype.getRootNode),ht=s(gt),vt=gt?function(n){return Bn.fromDom(n.dom.getRootNode())}:at,bt=function(n){return Bn.fromDom(n.dom.host)},wt=function(n){var t=rt(n)?n.dom.parentNode:n.dom;if(null==t||null===t.ownerDocument)return!1;var e,r,o=t.ownerDocument;return function(n){var t,e=vt(n);return ut(t=e)&&c(t.dom.host)?S.some(e):S.none()}(Bn.fromDom(t)).fold((function(){return o.body.contains(t)}),(e=wt,r=bt,function(n){return e(r(n))}))},yt=function(n){var t=n.dom.body;if(null==t)throw new Error("Body is not available yet");return Bn.fromDom(t)},xt=function(n,t){var e=[];return E(mt(n),(function(n){t(n)&&(e=e.concat([n])),e=e.concat(xt(n,t))})),e},Ct=function(n,t,e){return r=function(n){return En(n,t)},P(ft(n,e),r);var r},St=function(n,t){return e=function(n){return En(n,t)},P(mt(n),e);var e},Tt=function(n,t){return e=t,o=void 0===(r=n)?document:r.dom,Pn(o)?[]:B(o.querySelectorAll(e),Bn.fromDom);var e,r,o};function Rt(n,t,e,r,o){return n(e,r)?S.some(e):a(o)&&o(e)?S.none():t(e,r,o)}var Dt,Ot,At=function(n,t,e){for(var r=n.dom,o=a(e)?e:b;r.parentNode;){r=r.parentNode;var u=Bn.fromDom(r);if(t(u))return S.some(u);if(o(u))break}return S.none()},kt=function(n,t,e){return At(n,(function(n){return En(n,t)}),e)},Bt=function(n,t){return e=function(n){return En(n,t)},N(n.dom.childNodes,(function(n){return e(Bn.fromDom(n))})).map(Bn.fromDom);var e},Et=function(n,t){return e=t,o=void 0===(r=n)?document:r.dom,Pn(o)?S.none():S.from(o.querySelector(e)).map(Bn.fromDom);var e,r,o},Pt=function(n,t,e){return Rt(En,kt,n,t,e)},It=function(n,t,r){if(!(e(r)||u(r)||l(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,r+"")},Mt=function(n,t,e){It(n.dom,t,e)},Nt=function(n,t){var e=n.dom;zn(t,(function(n,t){It(e,t,n)}))},Wt=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},Lt=function(n,t){return S.from(Wt(n,t))},zt=function(n,t){n.dom.removeAttribute(t)},_t=function(n){return M(n.dom.attributes,(function(n,t){return n[t.name]=t.value,n}),{})},jt=function(n){return void 0!==n.style&&a(n.style.getPropertyValue)},Ft=function(n,t,r){if(!e(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);jt(n)&&n.style.setProperty(t,r)},Ht=function(n,t,e){var r=n.dom;Ft(r,t,e)},qt=function(n,t){var e=n.dom;zn(t,(function(n,t){Ft(e,t,n)}))},Vt=function(n,t){var e=n.dom,r=window.getComputedStyle(e).getPropertyValue(t);return""!==r||wt(n)?r:Ut(e,t)},Ut=function(n,t){return jt(n)?n.style.getPropertyValue(t):""},Kt=function(n,t){var e=n.dom,r=Ut(e,t);return S.from(r).filter((function(n){return 0<n.length}))},$t=function(n,t){var e,r,o=n.dom;r=t,jt(e=o)&&e.style.removeProperty(r),Lt(n,"style").map(un).is("")&&zt(n,"style")},Gt=function(n,t,e){return void 0===e&&(e=0),Lt(n,t).map((function(n){return parseInt(n,10)})).getOr(e)},Xt=function(n,t){return Gt(n,t,1)},Yt=function(n){return 1<Xt(n,"colspan")},Jt=function(n){return 1<Xt(n,"rowspan")},Qt=function(n,t){return parseInt(Vt(n,t),10)},Zt=s(10),ne=s(10),te=function(n,t){return ee(n,t,w)},ee=function(n,t,e){return z(mt(n),(function(n){return En(n,t)?e(n)?[n]:[]:ee(n,t,e)}))},re=function(n,t){return function(n,t,e){return void 0===e&&(e=b),e(t)?S.none():O(n,Qn(t))?S.some(t):kt(t,n.join(","),(function(n){return En(n,"table")||e(n)}))}(["td","th"],n,t)},oe=function(n){return te(n,"th,td")},ue=function(n){return En(n,"colgroup")?St(n,"col"):z(ae(n),(function(n){return St(n,"col")}))},ie=function(n,t){return Pt(n,"table",t)},ce=function(n){return te(n,"tr")},ae=function(n){return ie(n).fold(s([]),(function(n){return St(n,"colgroup")}))},le=function(n,t){return B(n,(function(n){if("colgroup"===Qn(n)){var e=B(ue(n),(function(n){var t=Gt(n,"span",1);return Gn(n,1,t)}));return Xn(n,e,"colgroup")}return e=B(oe(n),(function(n){var t=Gt(n,"rowspan",1),e=Gt(n,"colspan",1);return Gn(n,t,e)})),Xn(n,e,t(n))}))},fe=function(n){return lt(n).map((function(n){var t=Qn(n);return O($n,t)?t:"tbody"})).getOr("tbody")},se=function(n){var t=ce(n),e=$(ae(n),t);return le(e,fe)},de=function(n,t,e){var r=n.cells,o=r.slice(0,t),u=r.slice(t),i=o.concat(e).concat(u);return ge(n,i)},me=function(n,t,e){return de(n,t,[e])},pe=function(n,t,e){n.cells[t]=e},ge=function(n,t){return Jn(t,n.section)},he=function(n,t){var e=n.cells,r=B(e,t);return Jn(r,n.section)},ve=function(n,t){return n.cells[t]},be=function(n,t){return ve(n,t).element},we=function(n){return n.cells.length},ye=function(n){var t=function(n,t){for(var e=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(t(i)?e:r).push(i)}return{pass:e,fail:r}}(n,(function(n){return"colgroup"===n.section}));return{rows:t.fail,cols:t.pass}},xe="data-snooker-locked-cols",Ce=function(n){return Lt(n,xe).bind((function(n){return S.from(n.match(/\d+/g))})).map((function(n){return j(n,w)}))},Se=function(n){var t,e,r=M(ye(n).rows,(function(n,t){return E(t.cells,(function(t,e){t.isLocked&&(n[e]=!0)})),n}),{});return t=Hn(r,(function(n,t){return parseInt(t,10)})),(e=T.call(t,0)).sort(undefined),e},Te=function(n,t){return n+","+t},Re=function(n,t){var e=z(n.all,(function(n){return n.cells}));return P(e,t)},De=function(n){var t={},e=[],r={},o=q(n).map((function(n){return n.element})).bind(ie).bind(Ce).getOr({}),u=0,i=0,c=0;return E(n,(function(n){var a,l,f;"colgroup"===n.section?(l={},f=0,E(n.cells,(function(n){var t=n.colspan;k(t,(function(e){var r=f+e;l[r]={element:n.element,colspan:t,column:r}})),f+=t})),r=l):(a=[],E(n.cells,(function(n){for(var e=0;void 0!==t[Te(c,e)];)e++;for(var r=Kn(o,e.toString()),u={element:n.element,rowspan:n.rowspan,colspan:n.colspan,row:c,column:e,isLocked:r},l=0;l<n.colspan;l++)for(var f=0;f<n.rowspan;f++){var s=e+l,d=Te(c+f,s);t[d]=u,i=Math.max(i,s+1)}a.push(u)})),u++,e.push(Xn(n.element,a,n.section)),c++)})),{grid:{rows:u,columns:i},access:t,all:e,columns:r}},Oe=function(n){var t=se(n);return De(t)},Ae=De,ke=function(n,t,e){var r=n.access[Te(t,e)];return void 0!==r?S.some(r):S.none()},Be=function(n,t,e){var r=Re(n,(function(n){return e(t,n.element)}));return 0<r.length?S.some(r[0]):S.none()},Ee=Re,Pe=function(n){return z(n.all,(function(n){return n.cells}))},Ie=function(n){return t=n.columns,Hn(t,(function(n){return n}));var t},Me=function(n){return 0<Wn(n.columns).length},Ne=function(n,t){return S.from(n.columns[t])},We=function(n,t){var e=t.column,r=t.column+t.colspan-1,o=t.row,u=t.row+t.rowspan-1;return e<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&u>=n.startRow},Le=function(n,t){return t.column>=n.startCol&&t.column+t.colspan-1<=n.finishCol&&t.row>=n.startRow&&t.row+t.rowspan-1<=n.finishRow},ze=function(n,t,e){var r=Be(n,t,In),o=Be(n,e,In);return r.bind((function(n){return o.map((function(t){return e=n,r=t,{startRow:Math.min(e.row,r.row),startCol:Math.min(e.column,r.column),finishRow:Math.max(e.row+e.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,r.column+r.colspan-1)};var e,r}))}))},_e=function(n,t,e){return ze(n,t,e).map((function(t){var e=Ee(n,m(We,t));return B(e,(function(n){return n.element}))}))},je=function(n,t){return Be(n,t,(function(n,t){return Mn(t,n)})).map((function(n){return n.element}))},Fe=function(n,t,e,r,o){var u=He(n),i=In(n,e)?S.some(t):je(u,t),c=In(n,o)?S.some(r):je(u,r);return i.bind((function(n){return c.bind((function(t){return _e(u,n,t)}))}))},He=Oe,qe=function(n,t){lt(n).each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},Ve=function(n,t){dt(n).fold((function(){lt(n).each((function(n){Ke(n,t)}))}),(function(n){qe(n,t)}))},Ue=function(n,t){pt(n,0).fold((function(){Ke(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},Ke=function(n,t){n.dom.appendChild(t.dom)},$e=function(n,t){qe(n,t),Ke(t,n)},Ge=function(n,t){E(t,(function(e,r){var o=0===r?n:t[r-1];Ve(o,e)}))},Xe=function(n,t){E(t,(function(t){Ke(n,t)}))},Ye=function(n){n.dom.textContent="",E(mt(n),(function(n){Je(n)}))},Je=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Qe=function(n){var t,e=mt(n);0<e.length&&(t=n,E(e,(function(n){qe(t,n)}))),Je(n)},Ze=(Dt=rt,"text",{get:function(n){if(!Dt(n))throw new Error("Can only get text value of a text node");return Ot(n).getOr("")},getOption:Ot=function(n){return Dt(n)?S.from(n.dom.nodeValue):S.none()},set:function(n,t){if(!Dt(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=t}}),nr=function(n){return Ze.get(n)},tr=function(n){return Ze.getOption(n)},er=function(n,t){return Ze.set(n,t)},rr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function or(){return{up:s({selector:kt,closest:Pt,predicate:At,all:ft}),down:s({selector:Tt,predicate:xt}),styles:s({get:Vt,getRaw:Kt,set:Ht,remove:$t}),attrs:s({get:Wt,set:Mt,remove:zt,copyTo:function(n,t){var e=_t(n);Nt(t,e)}}),insert:s({before:qe,after:Ve,afterAll:Ge,append:Ke,appendAll:Xe,prepend:Ue,wrap:$e}),remove:s({unwrap:Qe,remove:Je}),create:s({nu:Bn.fromTag,clone:function(n){return Bn.fromDom(n.dom.cloneNode(!1))},text:Bn.fromText}),query:s({comparePosition:function(n,t){return n.dom.compareDocumentPosition(t.dom)},prevSibling:st,nextSibling:dt}),property:s({children:mt,name:Qn,parent:lt,document:function(n){return at(n).dom},isText:rt,isComment:tt,isElement:et,isSpecial:function(n){var t=Qn(n);return O(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getText:nr,setText:er,isBoundary:function(n){return!!et(n)&&("body"===Qn(n)||O(rr,Qn(n)))},isEmptyTag:function(n){return!!et(n)&&O(["br","img","hr","input"],Qn(n))},isNonEditable:function(n){return et(n)&&"false"===Wt(n,"contenteditable")}}),eq:In,is:Nn}}var ur,ir,cr,ar,lr=function(n,t,e){return t.bind((function(t){return e.filter(m(n.eq,t))}))},fr=function(n,t,e){return 0<e.length?function(n,t,e,r){var o=t(n,e);return I(r,(function(e,r){var o=t(n,r);return lr(n,e,o)}),o)}(n,t,(r=e)[0],r.slice(1)):S.none();var r},sr=or(),dr=function(n,t){return fr(sr,(function(t,e){return n(e)}),t)},mr=function(n){return kt(n,"table")},pr=function(n,t,e){var r=function(n){return function(t){return void 0!==e&&e(t)||In(t,n)}};return In(n,t)?S.some({boxes:S.some([n]),start:n,finish:t}):mr(n).bind((function(o){return mr(t).bind((function(u){if(In(o,u))return S.some({boxes:(l=n,f=t,s=He(o),_e(s,l,f)),start:n,finish:t});if(Mn(o,u)){var i=0<(c=Ct(t,"td,th",r(o))).length?c[c.length-1]:t;return S.some({boxes:Fe(o,n,o,t,u),start:n,finish:i})}if(Mn(u,o)){var c,a=0<(c=Ct(n,"td,th",r(u))).length?c[c.length-1]:n;return S.some({boxes:Fe(u,n,o,t,u),start:n,finish:a})}return function(n,t,e,r){void 0===r&&(r=b);var o=[t].concat(n.up().all(t)),u=[e].concat(n.up().all(e)),i=function(n){return W(n,r).fold((function(){return n}),(function(t){return n.slice(0,t+1)}))},c=i(o),a=i(u),l=N(c,(function(t){return A(a,(e=t,m(n.eq,e)));var e}));return{firstpath:c,secondpath:a,shared:l}}(sr,n,t,undefined).shared.bind((function(i){return Pt(i,"table",e).bind((function(e){var i=Ct(t,"td,th",r(e)),c=0<i.length?i[i.length-1]:t,a=Ct(n,"td,th",r(e)),l=0<a.length?a[a.length-1]:n;return S.some({boxes:Fe(e,n,o,t,u),start:l,finish:c})}))}));var l,f,s}))}))},gr=function(n,t){var e=Tt(n,t);return 0<e.length?S.some(e):S.none()},hr=function(n,t,e){return Et(n,t).bind((function(t){return Et(n,e).bind((function(n){return dr(mr,[t,n]).map((function(e){return{first:t,last:n,table:e}}))}))}))},vr=function(n,t,e,r,o){return u=o,N(n,(function(n){return En(n,u)})).bind((function(n){return function(n,t,e){return ie(n).bind((function(r){var o,u,i,c=He(r);return u=t,i=e,Be(o=c,n,In).bind((function(n){var t=0<u?n.row+n.rowspan-1:n.row,e=0<i?n.column+n.colspan-1:n.column;return ke(o,t+u,e+i).map((function(n){return n.element}))}))}))}(n,t,e).bind((function(n){return e=r,kt(t=n,"table").bind((function(n){return Et(n,e).bind((function(n){return pr(n,t).bind((function(n){return n.boxes.map((function(t){return{boxes:t,start:n.start,finish:n.finish}}))}))}))}));var t,e}))}));var u},br=gr,wr=function(n,t,e){return hr(n,t,e).bind((function(t){var e=function(t){return In(n,t)},r="thead,tfoot,tbody,table",o=kt(t.first,r,e),u=kt(t.last,r,e);return o.bind((function(n){return u.bind((function(e){return In(n,e)?(r=t.table,o=t.first,u=t.last,function(n,t,e){return ze(n,t,e).bind((function(t){return function(n,t){for(var e=!0,r=m(Le,t),o=t.startRow;o<=t.finishRow;o++)for(var u=t.startCol;u<=t.finishCol;u++)e=e&&ke(n,o,u).exists(r);return e?S.some(t):S.none()}(n,t)}))}(He(r),o,u)):S.none();var r,o,u}))}))}))},yr=function(n){if(!o(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return E(n,(function(r,u){var i=Wn(r);if(1!==i.length)throw new Error("one and only one name per case");var c=i[0],a=r[c];if(void 0!==e[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!o(a))throw new Error("case arguments must be an array");t.push(c),e[c]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=e.length;if(o!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+o);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+t.length);return t[u].apply(null,e)},match:function(n){var r=Wn(n);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!_(t,(function(n){return O(r,n)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return n[c].apply(null,e)},log:function(n){console.log(n,{constructors:t,constructor:c,params:e})}}}})),e},xr=yr([{none:[]},{multiple:["elements"]},{single:["element"]}]),Cr=function(n,t,e,r){return n.fold(t,e,r)},Sr=xr.none,Tr=xr.multiple,Rr=xr.single,Dr=tinymce.util.Tools.resolve("tinymce.PluginManager"),Or=function(n,t){return Bn.fromDom(n.dom.cloneNode(t))},Ar=function(n){return Or(n,!1)},kr=function(n){return Or(n,!0)},Br=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},Er=function(n,t){return n?S.some(t):S.none()},Pr=function(n,t){var e=function(e){var r=t(e);if(r<=0||null===r){var o=Vt(e,n);return parseFloat(o)||0}return r},r=function(n,t){return M(t,(function(t,e){var r=Vt(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,e){if(!l(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom;jt(r)&&(r.style[n]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(n,t,e){var o=r(n,e);return o<t?t-o:0}}},Ir=Pr("width",(function(n){return n.dom.offsetWidth})),Mr=function(n){return Ir.get(n)},Nr=function(n){return Ir.getOuter(n)},Wr=function(n,t){void 0===t&&(t=w);var e=n.grid,r=k(e.columns,d),o=k(e.rows,d);return B(r,(function(e){return Lr((function(){return z(o,(function(t){return ke(n,t,e).filter((function(n){return n.column===e})).toArray()}))}),(function(n){return 1===n.colspan&&t(n.element)}),(function(){return ke(n,0,e)}))}))},Lr=function(n,t,e){var r=n();return N(r,t).orThunk((function(){return S.from(r[0]).orThunk(e)})).map((function(n){return n.element}))},zr=function(n){var t=n.grid,e=k(t.rows,d),r=k(t.columns,d);return B(e,(function(t){return Lr((function(){return z(r,(function(e){return ke(n,t,e).filter((function(n){return n.row===t})).fold(s([]),(function(n){return[n]}))}))}),(function(n){return 1===n.rowspan}),(function(){return ke(n,t,0)}))}))},_r=function(n,t){return function(e){return"rtl"===jr(e)?t:n}},jr=function(n){return"rtl"===Vt(n,"direction")?"rtl":"ltr"},Fr=Pr("height",(function(n){var t=n.dom;return wt(n)?t.getBoundingClientRect().height:t.offsetHeight})),Hr=function(n){return Fr.get(n)},qr=function(n){return Fr.getOuter(n)},Vr=function(n,t){return{left:n,top:t,translate:function(e,r){return Vr(n+e,t+r)}}},Ur=Vr,Kr=function(n,t){return void 0!==n?n:void 0!==t?t:0},$r=function(n){var t=n.dom.ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom)return Ur(e.offsetLeft,e.offsetTop);var u=Kr(null==r?void 0:r.pageYOffset,o.scrollTop),i=Kr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Kr(o.clientTop,e.clientTop),a=Kr(o.clientLeft,e.clientLeft);return Gr(n).translate(i-a,u-c)},Gr=function(n){var t,e=n.dom,r=e.ownerDocument.body;return r===e?Ur(r.offsetLeft,r.offsetTop):wt(n)?(t=e.getBoundingClientRect(),Ur(t.left,t.top)):Ur(0,0)},Xr=function(n,t){return{row:n,y:t}},Yr=function(n,t){return{col:n,x:t}},Jr=function(n){return $r(n).left+Nr(n)},Qr=function(n){return $r(n).left},Zr=function(n,t){return Yr(n,Qr(t))},no=function(n,t){return Yr(n,Jr(t))},to=function(n){return $r(n).top},eo=function(n,t){return Xr(n,to(t))},ro=function(n,t){return Xr(n,to(t)+qr(t))},oo=function(n,t,e){if(0===e.length)return[];var r=B(e.slice(1),(function(t,e){return t.map((function(t){return n(e,t)}))})),o=e[e.length-1].map((function(n){return t(e.length-1,n)}));return r.concat([o])},uo={delta:d,positions:function(n){return oo(eo,ro,n)},edge:to},io=_r({delta:d,edge:Qr,positions:function(n){return oo(Zr,no,n)}},{delta:function(n){return-n},edge:Jr,positions:function(n){return oo(no,Zr,n)}}),co={delta:function(n,t){return io(t).delta(n,t)},positions:function(n,t){return io(t).positions(n,t)},edge:function(n){return io(n).edge(n)}},ao={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},lo=(ir="[eE][+-]?[0-9]+",ar=["Infinity",(ur="[0-9]+")+"\\."+(cr=function(n){return"(?:"+n+")?"})(ur)+cr(ir),"\\."+ur+cr(ir),ur+cr(ir)].join("|"),new RegExp("^([+-]?(?:"+ar+"))(.*)$")),fo=function(){var n=An().browser;return n.isIE()||n.isEdge()},so=function(n,t,e){return r=Vt(n,t),o=e,u=parseFloat(r),isNaN(u)?o:u;var r,o,u},mo=function(n){return fo()?(e=(t=n).dom.getBoundingClientRect().width,"border-box"===Vt(t,"box-sizing")?e:e-so(t,"padding-left",0)-so(t,"padding-right",0)-(so(t,"border-left-width",0)+so(t,"border-right-width",0))):so(n,"width",Mr(n));var t,e},po=/(\d+(\.\d+)?)%/,go=/(\d+(\.\d+)?)px|em/,ho=function(n,t){Ht(n,"width",t+"px")},vo=function(n,t){Ht(n,"width",t+"%")},bo=function(n,t){Ht(n,"height",t+"px")},wo=function(n){var t,e=Kt(t=n,"height").getOrThunk((function(){return function(n){return fo()?(e=(t=n).dom.getBoundingClientRect().height,"border-box"===Vt(t,"box-sizing")?e:e-so(t,"padding-top",0)-so(t,"padding-bottom",0)-(so(t,"border-top-width",0)+so(t,"border-bottom-width",0))):so(n,"height",Hr(n));var t,e}(t)+"px"}));return e?function(n,t,e,r){var o,u,i,c,a,l=parseInt(n,10);return on(n,"%")&&"table"!==Qn(t)?(u=l,i=e,c=r,a=ie(o=t).map((function(n){var t=i(n);return Math.floor(u/100*t)})).getOr(u),c(o,a),a):l}(e,n,Hr,bo):Hr(n)},yo=function(n){return Kt(n,"width").fold((function(){return S.from(Wt(n,"width"))}),(function(n){return S.some(n)}))},xo=function(n,t){return n/t.pixelWidth()*100},Co=function(n,t){return yo(n).fold((function(){var e=Mr(n);return xo(e,t)}),(function(e){return function(n,t,e){var r=po.exec(t);if(null!==r)return parseFloat(r[1]);var o=mo(n);return xo(o,e)}(n,e,t)}))},So=function(n,t){return yo(n).fold((function(){return mo(n)}),(function(e){return function(n,t,e){var r=go.exec(t);if(null!==r)return parseInt(r[1],10);var o=po.exec(t);return null===o?mo(n):parseFloat(o[1])/100*e.pixelWidth()}(n,e,t)}))},To=function(n){return"rowspan",wo(t=n)/Xt(t,"rowspan");var t},Ro=function(n,t,e){Ht(n,"width",t+e)},Do=function(n){return function(n,t){var e,r=(e=n,S.from(e.dom.offsetParent).map(Bn.fromDom).getOr(yt(ct(n))));return t(n)/t(r)*100}(n,Mr)+"%"},Oo=s(po),Ao=s(go),ko=it("col"),Bo=function(n,t,e){return Kt(n,t).fold((function(){return e(n)+"px"}),(function(n){return n}))},Eo=function(n,t){return Bo(n,"width",(function(n){return ko(n)?Mr(n):So(n,t)}))},Po=function(n){return Bo(n,"height",To)},Io=function(n,t){return Kt(n,t).isSome()},Mo=function(n,t,e,r,o,u){return n.filter(r).fold((function(){return u(function(n,t){if(t<0||t>=n.length-1)return S.none();var e=n[t].fold((function(){var e,r,o=(e=n.slice(0,t),(r=T.call(e,0)).reverse(),r);return U(o,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return S.some({value:n,delta:0})})),r=n[t+1].fold((function(){var e=n.slice(t+1);return U(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return S.some({value:n,delta:1})}));return e.bind((function(n){return r.map((function(t){var e=t.delta+n.delta;return Math.abs(t.value-n.value)/e}))}))}(e,t))}),(function(n){return o(n)}))},No=function(n,t,e,r,o){var u=Wr(n,(function(n){return Io(n,"width")})),i=Me(n)?B(Ie(n),(function(n){return S.from(n.element)})):u,c=[S.some(co.edge(t))].concat(B(co.positions(u,t),(function(n){return n.map((function(n){return n.x}))}))),a=v(Yt);return B(i,(function(n,t){return Mo(n,t,c,a,(function(n){if(!ko(l=n)||Io(l,"width"))return e(n,o);var i,l,f=null!=(i=u[t])?d(i):S.none();return Mo(f,t,c,a,(function(n){return r(S.some(Mr(n)))}),r)}),r)}))},Wo=function(n){return n.map((function(n){return n+"px"})).getOr("")},Lo=function(n,t,e){return No(n,t,So,(function(n){return n.getOrThunk(e.minCellWidth)}),e)},zo=function(n,t,e,r,o){var u=zr(n),i=[S.some(e.edge(t))].concat(B(e.positions(u,t),(function(n){return n.map((function(n){return n.y}))})));return B(u,(function(n,t){return Mo(n,t,i,v(Jt),r,o)}))},_o=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},jo=function(n,t){var e=_o(parseFloat(n)),r=_o(Mr(t));return{width:e.get,pixelWidth:r.get,getWidths:function(n,e){return No(n,t,Co,(function(n){return n.fold((function(){return r.minCellWidth()}),(function(n){return n/r.pixelWidth()*100}))}),r=e);var r},getCellDelta:function(n){return n/r.get()*100},singleColumnWidth:function(n,t){return[100-n]},minCellWidth:function(){return Zt()/r.get()*100},setElementWidth:vo,adjustTableWidth:function(n){var o=e.get(),u=o+n/100*o;vo(t,u),e.set(u),r.set(Mr(t))},isRelative:!0,label:"percent"}},Fo=function(n,t){var e=_o(n),r=e.get;return{width:r,pixelWidth:r,getWidths:function(n,e){return Lo(n,t,e)},getCellDelta:d,singleColumnWidth:function(n,t){return[Math.max(Zt(),n+t)-n]},minCellWidth:Zt,setElementWidth:ho,adjustTableWidth:function(n){var o=r()+n;ho(t,o),e.set(o)},isRelative:!1,label:"pixel"}},Ho=function(n){return yo(n).fold((function(){return function(n){var t=function(){return Mr(n)},e=s(0);return{width:t,pixelWidth:t,getWidths:function(t,e){return Lo(t,n,e)},getCellDelta:e,singleColumnWidth:s([0]),minCellWidth:e,setElementWidth:f,adjustTableWidth:f,isRelative:!0,label:"none"}}(n)}),(function(t){return function(n,t){var e=Oo().exec(t);if(null!==e)return jo(e[1],n);var r=Ao().exec(t);if(null!==r){var o=parseInt(r[1],10);return Fo(o,n)}var u=Mr(n);return Fo(u,n)}(n,t)}))},qo=Fo,Vo=jo,Uo=function(n,t){var e,r,o,u,i,c,a,l,f,s=function(n){return En(n.element,t)},d=kr(n),m=se(d),p=Ho(n),g=Ae(m),h=(r=s,o=(e=g).grid.columns,u=e.grid.rows,i=o,a=c=0,l=[],f=[],zn(e.access,(function(n){var t,e,o,s;l.push(n),r(n)&&(f.push(n),e=(t=n.row)+n.rowspan-1,s=(o=n.column)+n.colspan-1,t<u?u=t:c<e&&(c=e),o<i?i=o:a<s&&(a=s))})),{minRow:u,minCol:i,maxRow:c,maxCol:a,allCells:l,selectedCells:f}),v="th:not("+t+"),td:not("+t+")",b=ee(d,"th,td",(function(n){return En(n,v)}));return E(b,Je),function(n,t,e,r){for(var o,u,i,c=t.grid.columns,a=t.grid.rows,l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<e.minRow||l>e.maxRow||s<e.minCol||s>e.maxCol||(ke(t,l,s).filter(r).isNone()?(o=f,u=n[l].element,i=Bn.fromTag("td"),Ke(i,Bn.fromTag("br")),(o?Ke:Ue)(u,i)):f=!0)}(m,g,h,s),function(n,t,e,r){zn(e.columns,(function(n){(n.column<t.minCol||n.column>t.maxCol)&&Je(n.element)}));var o=P(te(n,"tr"),(function(n){return 0===n.dom.childElementCount}));E(o,Je),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||E(te(n,"th,td"),(function(n){zt(n,"rowspan"),zt(n,"colspan")})),zt(n,xe),zt(n,"data-snooker-col-series"),Ho(n).adjustTableWidth(r)}(d,h,g,function(n,t,e,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var o=Lo(t,n,e),u=M(o,(function(n,t){return n+t}),0),i=M(o.slice(r.minCol,r.maxCol+1),(function(n,t){return n+t}),0)/u*e.pixelWidth()-e.pixelWidth();return e.getCellDelta(i)}(n,Oe(n),p,h)),d},Ko=function(n){return"img"===Qn(n)?1:tr(n).fold((function(){return mt(n).length}),(function(n){return n.length}))},$o=["img","br"],Go=function(n){return tr(n).filter((function(n){return 0!==n.trim().length||-1<n.indexOf(" ")})).isSome()||O($o,Qn(n))},Xo=function(n){return t=Go,(e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=Bn.fromDom(n.childNodes[r]);if(t(o))return S.some(o);var u=e(n.childNodes[r]);if(u.isSome())return u}return S.none()})(n.dom);var t,e},Yo=function(n){return Jo(n,Go)},Jo=function(n,t){var e=function(n){for(var r=mt(n),o=r.length-1;0<=o;o--){var u=r[o];if(t(u))return S.some(u);var i=e(u);if(i.isSome())return i}return S.none()};return e(n)},Qo={scope:["row","col"]},Zo=function(){var n=Bn.fromTag("td");return Ke(n,Bn.fromTag("br")),n},nu=function(){return Bn.fromTag("col")},tu=function(){return Bn.fromTag("colgroup")},eu=function(n,t,e){var r=function(n,t){var e,r,o,u=(e=n,r=Bn.fromTag(t),o=_t(e),Nt(r,o),r),i=mt(kr(n));return Xe(u,i),u}(n,t);return zn(e,(function(n,t){null===n?zt(r,t):Mt(r,t,n)})),r},ru=function(n){return n},ou=function(n){return function(){return Bn.fromTag("tr",n.dom)}},uu=function(n,t,e){var r=function(n,t){var e,r,o;e=t,r=n.element.dom,o=e.dom,jt(r)&&jt(o)&&(o.style.cssText=r.style.cssText),$t(t,"height"),1!==n.colspan&&$t(t,"width")};return{col:function(t){var e=ct(t.element),o=Bn.fromTag(Qn(t.element),e.dom);return r(t,o),n(t.element,o),o},colgroup:tu,row:ou(t),cell:function(t){var o,u,i,c,a,l=ct(t.element),f=Bn.fromTag(Qn(t.element),l.dom),s=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),d=0<s.length?(o=t.element,u=f,i=s,Xo(o).map((function(n){var t=i.join(","),e=Ct(n,t,(function(n){return In(n,o)}));return I(e,(function(n,t){var e=Ar(t);return zt(e,"contenteditable"),Ke(n,e),e}),u)})).getOr(u)):f;return Ke(d,Bn.fromTag("br")),r(t,f),c=t.element,a=f,zn(Qo,(function(n,t){return Lt(c,t).filter((function(t){return O(n,t)})).each((function(n){return Mt(a,t,n)}))})),n(t.element,f),f},replace:eu,gap:Zo}},iu=function(n){return{col:nu,colgroup:tu,row:ou(n),cell:Zo,replace:ru,gap:Zo}},cu=function(n){return B(n,Bn.fromDom)},au=function(n){return n.nodeName.toLowerCase()},lu=function(n){return Bn.fromDom(n.getBody())},fu=function(n){return n.getBoundingClientRect().width},su=function(n){return n.getBoundingClientRect().height},du=function(n){return function(t){return In(t,lu(n))}},mu=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},pu=function(n){zt(n,"data-mce-style");var t=function(n){return zt(n,"data-mce-style")};E(oe(n),t),E(ue(n),t)},gu=function(n,t){var e=n.dom.getStyle(t,"width")||n.dom.getAttrib(t,"width");return S.from(e).filter(cn)},hu=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},vu=function(n){return Bn.fromDom(n.selection.getStart())},bu=function(n){return Cr(n.get(),s([]),d,F)},wu={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},yu=function(n,t,e){return{element:e,mergable:(u=t,i=wu,Cr(n.get(),S.none,(function(n){return n.length<=1?S.none():wr(u,i.firstSelectedSelector,i.lastSelectedSelector).map((function(t){return{bounds:t,cells:n}}))}),S.none)),unmergable:(r=function(n,t){return Lt(n,t).exists((function(n){return 1<parseInt(n,10)}))},0<(o=bu(n)).length&&_(o,(function(n){return r(n,"rowspan")||r(n,"colspan")}))?S.some(o):S.none()),selection:bu(n)};var r,o,u,i},xu=yr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Cu=K({},xu),Su=function(n,t,e){for(var r=0,o=n;o<t;o++)r+=void 0!==e[o]?e[o]:0;return r},Tu=function(n,t,e){var r=function(n,t){return Me(n)?(o=t,u=Ie(n),B(u,(function(n,t){return{element:n.element,width:o[t],colspan:n.colspan}}))):(e=t,r=Pe(n),B(r,(function(n){var t=Su(n.column,n.column+n.colspan,e);return{element:n.element,width:t,colspan:n.colspan}})));var e,r,o,u}(n,t);E(r,(function(n){e.setElementWidth(n.element,n.width)}))},Ru=function(n,t,e,r,o){var u=Oe(n),i=o.getCellDelta(t),c=o.getWidths(u,o),a=e===u.grid.columns-1,l=r.clampTableDelta(c,e,i,o.minCellWidth(),a),f=function(n,t,e,r,o){var u,i,c=n.slice(0),a=(i=t,0===(u=n).length?Cu.none():1===u.length?Cu.only(0):0===i?Cu.left(0,1):i===u.length-1?Cu.right(i-1,i):0<i&&i<u.length-1?Cu.middle(i-1,i,i+1):Cu.none()),l=s(B(c,s(0)));return a.fold(l,(function(n){return r.singleColumnWidth(c[n],e)}),(function(n,t){return o.calcLeftEdgeDeltas(c,n,t,e,r.minCellWidth(),r.isRelative)}),(function(n,t,u){return o.calcMiddleDeltas(c,n,t,u,e,r.minCellWidth(),r.isRelative)}),(function(n,t){return o.calcRightEdgeDeltas(c,n,t,e,r.minCellWidth(),r.isRelative)}))}(c,e,l,o,r),d=B(f,(function(n,t){return n+c[t]}));Tu(u,d,o),r.resizeTable(o.adjustTableWidth,l,a)},Du=function(n){return B(n,s(0))},Ou=function(n,t,e,r,o){return o(n.slice(0,t)).concat(r).concat(o(n.slice(e)))},Au=function(n){return function(t,e,r,o){if(n(r)){var u=Math.max(o,t[e]-Math.abs(r)),i=Math.abs(u-t[e]);return 0<=r?i:-i}return r}},ku=Au((function(n){return n<0})),Bu=Au(w),Eu=function(){var n=function(n,t,e,r){var o=(100+e)/100,u=Math.max(r,(n[t]+e)/o);return B(n,(function(n,e){return(e===t?u:n/o)-n}))},t=function(t,e,r,o,u,i){return i?n(t,e,o,u):(l=r,f=ku(c=t,a=e,o,u),Ou(c,a,l+1,[f,0],Du));var c,a,l,f};return{resizeTable:function(n,t){return n(t)},clampTableDelta:ku,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(n,e,r,o,u,i,c){return t(n,r,o,u,i,c)},calcRightEdgeDeltas:function(t,e,r,o,u,i){if(i)return n(t,r,o,u);var c=ku(t,r,o,u);return Du(t.slice(0,r)).concat([c])},calcRedestributedWidths:function(n,t,e,r){if(r){var o=(t+e)/t,u=B(n,(function(n){return n/o}));return{delta:100*o-100,newSizes:u}}return{delta:e,newSizes:n}}}},Pu=function(){var n=function(n,t,e,r,o){var u=Bu(n,0<=r?e:t,r,o);return Ou(n,t,e+1,[u,-u],Du)};return{resizeTable:function(n,t,e){e&&n(t)},clampTableDelta:function(n,t,e,r,o){if(o){if(0<=e)return e;var u=M(n,(function(n,t){return n+t-r}),0);return Math.max(-u,e)}return ku(n,t,e,r)},calcLeftEdgeDeltas:n,calcMiddleDeltas:function(t,e,r,o,u,i){return n(t,r,o,u,i)},calcRightEdgeDeltas:function(n,t,e,r,o,u){if(u)return Du(n);var i=r/n.length;return B(n,s(i))},calcRedestributedWidths:function(n,t,e,r){return{delta:0,newSizes:n}}}},Iu=function(n,t){var e=S.from(n.dom.documentElement).map(Bn.fromDom).getOr(n);return{parent:s(e),view:s(n),origin:s(Ur(0,0)),isResizable:t}},Mu=yr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Nu=function(n,t,e){var r=e.substring(0,e.length-n.length),o=parseFloat(r);return r===o.toString()?t(o):Mu.invalid(e)},Wu=K(K({},Mu),{from:function(n){return on(n,"%")?Nu("%",Mu.percent,n):on(n,"px")?Nu("px",Mu.pixels,n):Mu.invalid(n)}}),Lu=function(n,t,e){var r,o,u,i=Wu.from(e),c=_(n,(function(n){return"0px"===n}))?(r=i,o=n.length,u=r.fold((function(){return s("")}),(function(n){return s(n/o+"px")}),(function(){return s(100/o+"%")})),k(o,u)):function(n,t,e){return n.fold((function(){return t}),(function(n){return o=(r=n)/e,B(t,(function(n){return Wu.from(n).fold((function(){return n}),(function(n){return n*o+"px"}),(function(n){return n/100*r+"px"}))}));var r,o}),(function(n){return r=e,B(t,(function(n){return Wu.from(n).fold((function(){return n}),(function(n){return n/r*100+"%"}),(function(n){return n+"%"}))}));var r}))}(i,n,t);return _u(c)},zu=function(n,t){return 0===n.length?t:I(n,(function(n,t){return Wu.from(t).fold(s(0),d,d)+n}),0)},_u=function(n){if(0===n.length)return n;var t,e,r=I(n,(function(n,t){var e=Wu.from(t).fold((function(){return{value:t,remainder:0}}),(function(n){return t=n,"px",{value:(e=Math.floor(t))+"px",remainder:t-e};var t,e}),(function(n){return{value:n+"%",remainder:0}}));return{output:[e.value].concat(n.output),remainder:n.remainder+e.remainder}}),{output:[],remainder:0}),o=r.output;return o.slice(0,o.length-1).concat([(t=o[o.length-1],e=Math.round(r.remainder),Wu.from(t).fold(s(t),(function(n){return n+e+"px"}),(function(n){return n+e+"%"})))])},ju=Wu.from,Fu=function(n){return ju(n).fold(s("px"),s("px"),s("%"))},Hu=function(n,t,e,r){var o=Oe(n),u=o.all,i=Pe(o),c=Ie(o);t.each((function(t){var e,u,a,l,f=Fu(t),s=Mr(n),d=No(o,n,Eo,Wo,r),m=Lu(d,s,t);Me(o)?(a=m,l=f,E(c,(function(n,t){var e=zu([a[t]],Zt());Ht(n.element,"width",e+l)}))):(e=m,u=f,E(i,(function(n){var t=e.slice(n.column,n.colspan+n.column),r=zu(t,Zt());Ht(n.element,"width",r+u)}))),Ht(n,"width",t)})),e.each((function(t){var e,r,c,a=Fu(t),l=Hr(n),f=zo(o,n,uo,Po,Wo),s=Lu(f,l,t);e=s,r=u,c=a,E(i,(function(n){var t=e.slice(n.row,n.rowspan+n.row),r=zu(t,ne());Ht(n.element,"height",r+c)})),E(r,(function(n,t){Ht(n.element,"height",e[t])})),Ht(n,"height",t)}))},qu=function(n){return yo(n).exists((function(n){return po.test(n)}))},Vu=function(n){return yo(n).exists((function(n){return go.test(n)}))},Uu=function(n){return yo(n).isNone()},Ku=Do,$u=function(n){return Oe(n).grid},Gu=function(n){var t=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");t.push(n)},unbind:function(n){t=P(t,(function(t){return t!==n}))},trigger:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o={};E(n,(function(n,t){o[n]=e[t]})),E(t,(function(n){n(o)}))}}},Xu=function(n){return{registry:_n(n,(function(n){return{bind:n.bind,unbind:n.unbind}})),trigger:_n(n,(function(n){return n.trigger}))}},Yu=function(n){return n.slice(0).sort()},Ju=function(n,t){var e=P(t,(function(t){return!O(n,t)}));0<e.length&&function(n){throw new Error("Unsupported keys for object: "+Yu(n).join(", "))}(e)},Qu=function(n){return function(n,t,r){if(0===t.length)throw new Error("You must specify at least one required field.");var u;return function(n,t){if(!o(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");E(t,(function(t){if(!e(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")}))}("required",t),u=Yu(t),N(u,(function(n,t){return t<u.length-1&&n===u[t+1]})).each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+u.join(", ")+"].")})),function(e){var o=Wn(e);_(t,(function(n){return O(o,n)}))||function(n,t){throw new Error("All required keys ("+Yu(n).join(", ")+") were not specified. Specified keys were: "+Yu(t).join(", ")+".")}(t,o),n(t,o);var u=P(t,(function(n){return!r.validate(e[n],n)}));return 0<u.length&&function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+Yu(n).join(", ")+") were not.")}(u,r.label),e}}(Ju,n,{validate:a,label:"function"})},Zu=Qu(["compare","extract","mutate","sink"]),ni=Qu(["element","start","stop","destroy"]),ti=Qu(["forceDrop","drop","move","delayDrop"]),ei=function(){var n,t=(n=Xu({move:Gu(["info"])}),{onEvent:f,reset:f,events:n.registry}),e=function(){var n=S.none(),t=Xu({move:Gu(["info"])});return{onEvent:function(e,r){r.extract(e).each((function(e){var o,u,i;(o=r,u=e,i=n.map((function(n){return o.compare(n,u)})),n=S.some(u),i).each((function(n){t.trigger.move(n)}))}))},reset:function(){n=S.none()},events:t.registry}}(),r=t;return{on:function(){r.reset(),r=e},off:function(){r.reset(),r=t},isOn:function(){return r===e},onEvent:function(n,t){r.onEvent(n,t)},events:e.events}},ri=function(n){var t,e,r=Bn.fromDom(function(n){if(ht()&&c(n.target)){var t=Bn.fromDom(n.target);if(et(t)&&function(n){return c(n.dom.shadowRoot)}(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return q(e)}}return S.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(t=u,e=o,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))});return{target:r,x:n.clientX,y:n.clientY,stop:o,prevent:u,kill:i,raw:n}},oi=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},ui=w,ii=function(n,t,e){return function(n,t,e,r,o){var u,i,c=(u=e,i=r,function(n){u(n)&&i(ri(n))});return n.dom.addEventListener(t,c,o),{unbind:m(oi,n,t,c,o)}}(n,t,ui,e,!1)},ci=ri,ai=function(n){return void 0!==n.dom.classList},li=function(n,t){return r=t,o=function(n,t){var e=Wt(n,t);return void 0===e||""===e?[]:e.split(" ")}(e=n,"class").concat([r]),Mt(e,"class",o.join(" ")),!0;var e,r,o},fi=function(n,t){ai(n)?n.dom.classList.add(t):li(n,t)},si=function(n,t){return ai(n)&&n.dom.classList.contains(t)},di=function(n){var t=n.replace(/\./g,"-");return{resolve:function(n){return t+"-"+n}}},mi=di("ephox-dragster").resolve,pi=Zu({compare:function(n,t){return Ur(t.left-n.left,t.top-n.top)},extract:function(n){return S.some(Ur(n.x,n.y))},sink:function(n,t){var e=function(n){var t=K({layerClass:mi("blocker")},n),e=Bn.fromTag("div");return Mt(e,"role","presentation"),qt(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),fi(e,mi("blocker")),fi(e,t.layerClass),{element:function(){return e},destroy:function(){Je(e)}}}(t),r=ii(e.element(),"mousedown",n.forceDrop),o=ii(e.element(),"mouseup",n.drop),u=ii(e.element(),"mousemove",n.move),i=ii(e.element(),"mouseout",n.delayDrop);return ni({element:e.element,start:function(n){Ke(n,e.element())},stop:function(){Je(e.element())},destroy:function(){e.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,t){n.mutate(t.left,t.top)}}),gi=function(n){return"true"===Wt(n,"contenteditable")},hi=di("ephox-snooker").resolve,vi=hi("resizer-bar"),bi=hi("resizer-rows"),wi=hi("resizer-cols"),yi=function(n){var t=Tt(n.parent(),"."+vi);E(t,Je)},xi=function(n,t,e){var r=n.origin();E(t,(function(t){t.each((function(t){var o=e(r,t);fi(o,vi),Ke(n.parent(),o)}))}))},Ci=function(n,t,e,r,o){var u,i=$r(e),c=t.isResizable,a=0<r.length?uo.positions(r,e):[],l=0<a.length?(u=c,z(n.all,(function(n,t){return u(n.element)?[t]:[]}))):[];!function(n,t,e,r){xi(n,t,(function(n,t){var o,u,i,c,a,l=(o=t.row,u=e.left-n.left,i=t.y-n.top,c=r,a=Bn.fromTag("div"),qt(a,{position:"absolute",left:u+"px",top:i-3.5+"px",height:"7px",width:c+"px"}),Nt(a,{"data-row":o,role:"presentation"}),a);return fi(l,bi),l}))}(t,P(a,(function(n,t){return A(l,(function(n){return t===n}))})),i,Nr(e));var f,s,d,m=0<o.length?co.positions(o,e):[],p=0<m.length?(s=c,d=[],k((f=n).grid.columns,(function(n){Ne(f,n).map((function(n){return n.element})).forall(s)&&d.push(n)})),P(d,(function(n){var t=Ee(f,(function(t){return t.column===n}));return _(t,(function(n){return s(n.element)}))}))):[];!function(n,t,e,r){xi(n,t,(function(n,t){var o,u,i,c,a,l=(o=t.col,u=t.x-n.left,i=e.top-n.top,c=r,a=Bn.fromTag("div"),qt(a,{position:"absolute",left:u-3.5+"px",top:i+"px",height:c+"px",width:"7px"}),Nt(a,{"data-column":o,role:"presentation"}),a);return fi(l,wi),l}))}(t,P(m,(function(n,t){return A(p,(function(n){return t===n}))})),i,qr(e))},Si=function(n,t){var e,r,o;yi(n),n.isResizable(t)&&(e=Oe(t),r=zr(e),o=Wr(e),Ci(e,n,t,r,o))},Ti=function(n,t){var e=Tt(n.parent(),"."+vi);E(e,t)},Ri=function(n){Ti(n,(function(n){Ht(n,"display","none")}))},Di=function(n){Ti(n,(function(n){Ht(n,"display","block")}))},Oi=hi("resizer-bar-dragging"),Ai=function(n){var t=function(){var n,t=Xu({drag:Gu(["xDelta","yDelta","target"])}),e=S.none(),r={mutate:function(t,e){n.trigger.drag(t,e)},events:(n=Xu({drag:Gu(["xDelta","yDelta"])})).registry};return r.events.drag.bind((function(n){e.each((function(e){t.trigger.drag(n.xDelta,n.yDelta,e)}))})),{assign:function(n){e=S.some(n)},get:function(){return e},mutate:r.mutate,events:t.registry}}(),e=function(n,t){return void 0===t&&(t={}),function(n,t,e){var r,o,u=!1,i=Xu({start:Gu([]),stop:Gu([])}),c=ei(),a=function(){s.stop(),c.isOn()&&(c.off(),i.trigger.stop())},l=(r=a,o=null,{cancel:function(){null!==o&&(clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null!==o&&clearTimeout(o),o=setTimeout((function(){r.apply(null,n),o=null}),200)}});c.events.move.bind((function(e){t.mutate(n,e.info)}));var f=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u&&n.apply(null,t)}},s=t.sink(ti({forceDrop:a,drop:f(a),move:f((function(n){l.cancel(),c.onEvent(n,t)})),delayDrop:f(l.throttle)}),e);return{element:s.element,go:function(n){s.start(n),c.on(),i.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){s.destroy()},events:i.registry}}(n,void 0!==t.mode?t.mode:pi,t)}(t,{}),r=S.none(),o=function(n,t){return S.from(Wt(n,t))};t.events.drag.bind((function(n){o(n.target,"data-row").each((function(t){var e=Qt(n.target,"top");Ht(n.target,"top",e+n.yDelta+"px")})),o(n.target,"data-column").each((function(t){var e=Qt(n.target,"left");Ht(n.target,"left",e+n.xDelta+"px")}))}));var u=function(n,t){return Qt(n,t)-Gt(n,"data-initial-"+t,0)};e.events.stop.bind((function(){t.get().each((function(t){r.each((function(e){o(t,"data-row").each((function(n){var r=u(t,"top");zt(t,"data-initial-top"),f.trigger.adjustHeight(e,r,parseInt(n,10))})),o(t,"data-column").each((function(n){var r=u(t,"left");zt(t,"data-initial-left"),f.trigger.adjustWidth(e,r,parseInt(n,10))})),Si(n,e)}))}))}));var i=function(r,o){f.trigger.startAdjust(),t.assign(r),Mt(r,"data-initial-"+o,Qt(r,o)),fi(r,Oi),Ht(r,"opacity","0.2"),e.go(n.parent())},c=ii(n.parent(),"mousedown",(function(n){var t,e;t=n.target,si(t,bi)&&i(n.target,"top"),e=n.target,si(e,wi)&&i(n.target,"left")})),a=function(t){return In(t,n.view())},l=ii(n.view(),"mouseover",(function(t){(function(n){return Pt(n,"table",a).filter((function(n){return Pt(n,"[contenteditable]",a).exists(gi)}))})(t.target).fold((function(){wt(t.target)&&yi(n)}),(function(t){r=S.some(t),Si(n,t)}))})),f=Xu({adjustHeight:Gu(["table","delta","row"]),adjustWidth:Gu(["table","delta","column"]),startAdjust:Gu([])});return{destroy:function(){c.unbind(),l.unbind(),e.destroy(),yi(n)},refresh:function(t){Si(n,t)},on:e.on,off:e.off,hideBars:m(Ri,n),showBars:m(Di,n),events:f.registry}},ki=function(n,t,e){var r=uo,o=co,u=Ai(n),i=Xu({beforeResize:Gu(["table","type"]),afterResize:Gu(["table","type"]),startDrag:Gu([])});return u.events.adjustHeight.bind((function(n){var t=n.table;i.trigger.beforeResize(t,"row"),function(n,t,e,r){var o,u,i,c=Oe(n),a=zo(c,n,r,To,(function(n){return n.getOrThunk(ne)})),l=B(a,(function(n,r){return e===r?Math.max(t+n,ne()):n})),f=(o=l,u=Pe(c),B(u,(function(n){var t=Su(n.row,n.row+n.rowspan,o);return{element:n.element,height:t,rowspan:n.rowspan}}))),s=(i=l,B(c.all,(function(n,t){return{element:n.element,height:i[t]}})));E(s,(function(n){bo(n.element,n.height)})),E(f,(function(n){bo(n.element,n.height)}));var d=I(l,(function(n,t){return n+t}),0);bo(n,d)}(t,r.delta(n.delta,t),n.row,r),i.trigger.afterResize(t,"row")})),u.events.startAdjust.bind((function(n){i.trigger.startDrag()})),u.events.adjustWidth.bind((function(n){var r=n.table;i.trigger.beforeResize(r,"col");var u=o.delta(n.delta,r),c=e(r);Ru(r,u,n.column,t,c),i.trigger.afterResize(r,"col")})),{on:u.on,off:u.off,hideBars:u.hideBars,showBars:u.showBars,destroy:u.destroy,events:i.registry}},Bi=function(n,t){return n.fire("newrow",{node:t})},Ei=function(n,t){return n.fire("newcell",{node:t})},Pi=function(n,t,e){n.fire("TableModified",K(K({},e),{table:t}))},Ii={structure:!1,style:!0},Mi={structure:!0,style:!1},Ni={"border-collapse":"collapse",width:"100%"},Wi={border:"1"},Li="preservetable",zi=function(n){return n.getParam("table_sizing_mode","auto")},_i=function(n){return n.getParam("table_responsive_width")},ji=function(n){return n.getParam("table_default_attributes",Wi,"object")},Fi=function(n){return n.getParam("table_default_styles",function(n){if($i(n)){var t=n.getBody().offsetWidth;return K(K({},Ni),{width:t+"px"})}return Gi(n)?Fn(Ni,(function(n,t){return"width"!==t})):Ni}(n),"object")},Hi=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},qi=function(n){return n.getParam("table_row_advtab",!0,"boolean")},Vi=function(n){return n.getParam("table_advtab",!0,"boolean")},Ui=function(n){return n.getParam("table_style_by_css",!1,"boolean")},Ki=function(n){return"relative"===zi(n)||!0===_i(n)},$i=function(n){return"fixed"===zi(n)||!1===_i(n)},Gi=function(n){return"responsive"===zi(n)},Xi=function(n){var t="section",e=n.getParam("table_header_type",t,"string");return O(["section","cells","sectionCells","auto"],e)?e:t},Yi=function(n){var t=n.getParam("table_column_resizing",Li,"string");return N(["preservetable","resizetable"],(function(n){return n===t})).getOr(Li)},Ji=function(n){return"preservetable"===Yi(n)},Qi=function(n){return"resizetable"===Yi(n)},Zi=function(n){var t=n.getParam("table_clone_elements");return e(t)?S.some(t.split(/[ ,]/)):Array.isArray(t)?S.some(t):S.none()},nc=function(n,t){if(Ki(n)){var e=gu(n,t.dom).filter(hu).getOrThunk((function(){return Ku(t)}));return Vo(e,t)}return $i(n)?qo(Mr(t),t):Ho(t)},tc=function(n){zt(n,"width")},ec=function(n,t){var e,r,o;r=nc(n,t),o=Do(e=t),Hu(e,S.some(o),S.none(),r),tc(e)},rc=function(n,t){!function(n,t){var e=Mr(n)+"px";Hu(n,S.some(e),S.none(),t),tc(n)}(t,nc(n,t))},oc=function(n){$t(n,"width");var t=ue(n),e=0<t.length?t:oe(n);E(e,(function(n){$t(n,"width"),tc(n)})),tc(n)},uc="bar-",ic=function(n){return"false"!==Wt(n,"data-mce-resize")},cc=function(n){var t,r,o=S.none(),u=S.none(),i=S.none(),c=function(n){return"TABLE"===n.nodeName},a=function(t){return nc(n,t)},l=function(){return(Ji(n)?Pu:Eu)()};return n.on("init",(function(){var t,r,c,f,d,m=(r=ic,(t=n).inline?function(n,t,e){return{parent:s(t),view:s(n),origin:s(Ur(0,0)),isResizable:e}}(lu(t),function(){var n=Bn.fromTag("div");return qt(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Ke(yt(Bn.fromDom(document)),n),n}(),r):Iu(Bn.fromDom(t.getDoc()),r));i=S.some(m),d=n.getParam("object_resizing",!0),(e(d)?"table"===d:d)&&n.getParam("table_resize_bars",!0,"boolean")&&(c=l(),(f=ki(m,c,a)).on(),f.events.startDrag.bind((function(t){o=S.some(n.selection.getRng())})),f.events.beforeResize.bind((function(t){var e,r,o,u,i,c=t.table.dom;e=n,o=fu(r=c),u=su(c),i=uc+t.type,e.fire("ObjectResizeStart",{target:r,width:o,height:u,origin:i})})),f.events.afterResize.bind((function(t){var e,r,u,i,c,a=t.table,l=a.dom;pu(a),o.each((function(t){n.selection.setRng(t),n.focus()})),e=n,u=fu(r=l),i=su(l),c=uc+t.type,e.fire("ObjectResized",{target:r,width:u,height:i,origin:c}),n.undoManager.add()})),u=S.some(f))})),n.on("ObjectResizeStart",(function(e){var o,u=e.target;c(u)&&(o=Bn.fromDom(u),E(n.dom.select(".mce-clonedresizable"),(function(t){n.dom.addClass(t,"mce-"+Yi(n)+"-columns")})),!Vu(o)&&$i(n)?rc(n,o):!qu(o)&&Ki(n)&&ec(n,o),Uu(o)&&rn(e.origin,uc)&&ec(n,o),t=e.width,r=Gi(n)?"":gu(n,u).getOr(""))})),n.on("ObjectResized",(function(e){var o,u,i=e.target;c(i)&&(o=Bn.fromDom(i),u=e.origin,rn(u,"corner-")&&function(e,o,u){var i,c,f,s,d,m,p=on(o,"e");""===r&&ec(n,e),u!==t&&""!==r?(Ht(e,"width",r),i=l(),c=a(e),f=Ji(n)||p?$u(e).columns-1:0,Ru(e,u-t,f,i,c)):hu(r)&&(s=parseFloat(r.replace("%","")),Ht(e,"width",u*s/t+"%")),/^(\d+(\.\d+)?)px$/.test(r)&&(m=Oe(d=e),Me(m)||E(oe(d),(function(n){var t=Vt(n,"width");Ht(n,"width",t),zt(n,"width")})))}(o,u,e.width),pu(o),Pi(n,o.dom,Ii))})),n.on("SwitchMode",(function(){u.each((function(t){n.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:function(){return u},lazyWire:function(){return i.getOr(Iu(Bn.fromDom(n.getBody()),ic))},destroy:function(){u.each((function(n){n.destroy()})),i.each((function(t){var e;e=t,n.inline&&Je(e.parent())}))}}},ac=function(n,t){return{element:n,offset:t}},lc=function(n,t,e){return n.property().isText(t)&&0===n.property().getText(t).trim().length||n.property().isComment(t)?e(t).bind((function(t){return lc(n,t,e).orThunk((function(){return S.some(t)}))})):S.none()},fc=function(n,t){return n.property().isText(t)?n.property().getText(t).length:n.property().children(t).length},sc=function(n,t){var e=lc(n,t,n.query().prevSibling).getOr(t);if(n.property().isText(e))return ac(e,fc(n,e));var r=n.property().children(e);return 0<r.length?sc(n,r[r.length-1]):ac(e,fc(n,e))},dc=sc,mc=or(),pc=function(n,t){1===Xt(n,"colspan")&&yo(n).bind((function(n){return function(n,t){return S.from(lo.exec(n)).bind((function(n){var e,r=Number(n[1]),o=n[2];return e=o,A(t,(function(n){return A(ao[n],(function(n){return e===n}))}))?S.some({value:r,unit:o}):S.none()}))}(n,["fixed","relative","empty"])})).each((function(e){var r=e.value/2;Ro(n,r,e.unit),Ro(t,r,e.unit)}))},gc=function(n,t,e,r){e===r?zt(n,t):Mt(n,t,e)},hc=function(n,t,e){V(St(n,t)).fold((function(){return Ue(n,e)}),(function(n){return Ve(n,e)}))},vc=function(n,t){var e=[],r=[],o=function(n){return B(n,(function(n){n.isNew&&e.push(n.element);var t=n.element;return Ye(t),E(n.cells,(function(n){n.isNew&&r.push(n.element),gc(n.element,"colspan",n.colspan,1),gc(n.element,"rowspan",n.rowspan,1),Ke(t,n.element)})),t}))},u=function(n){return z(n,(function(n){return B(n.cells,(function(n){return gc(n.element,"span",n.colspan,1),n.element}))}))},i=function(t,e){var r,i,c,a=(c=Bt(r=n,i=e).getOrThunk((function(){var n=Bn.fromTag(i,ct(r).dom);return"thead"===i?hc(r,"caption,colgroup",n):"colgroup"===i?hc(r,"caption",n):Ke(r,n),n})),Ye(c),c),l=("colgroup"===e?u:o)(t);Xe(a,l)},c=function(t,e){0<t.length?i(t,e):Bt(n,e).each(Je)},a=[],l=[],f=[],s=[];return E(t,(function(n){switch(n.section){case"thead":a.push(n);break;case"tbody":l.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}})),c(s,"colgroup"),c(a,"thead"),c(l,"tbody"),c(f,"tfoot"),{newRows:e,newCells:r}},bc=function(n,t){if(0===n.length)return 0;var e=n[0];return W(n,(function(n){return!t(e.element,n.element)})).fold((function(){return n.length}),(function(n){return n}))},wc=function(n,t){var e=B(n,(function(n){return B(n.cells,b)}));return B(n,(function(r,o){return{details:z(r.cells,(function(r,u){if(!1!==e[o][u])return[];var i=function(n,t,e,r){var o,u=n[t].cells.slice(e),i=bc(u,r),c=(o=e,B(n,(function(n){return ve(n,o)})).slice(t));return{colspan:i,rowspan:bc(c,r)}}(n,o,u,t);return function(n,t,r,o){for(var u=n;u<n+r;u++)for(var i=t;i<t+o;i++)e[u][i]=!0}(o,u,i.rowspan,i.colspan),[{element:r.element,rowspan:i.rowspan,colspan:i.colspan,isNew:r.isNew}]})),section:r.section}}))},yc=function(n,t,e){var r,o=[];Me(n)&&(r=B(Ie(n),(function(n){return Yn(n.element,e,!1)})),o.push(Jn(r,"colgroup")));for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var a=ke(n,u,c).map((function(n){return Yn(n.element,e,n.isLocked)})).getOrThunk((function(){return Yn(t.gap(),!0,!1)}));i.push(a)}var l=Jn(i,n.all[u].section);o.push(l)}return o},xc=function(n,t){return function(n,t){return B(n,(function(n){var e,r=(e=n.details,U(e,(function(n){return lt(n.element).map((function(n){var t=lt(n).isNone();return Yn(n,t,!1)}))})).getOrThunk((function(){return Yn(t.row(),!0,!1)})));return{element:r.element,cells:n.details,section:n.section,isNew:r.isNew}}))}(wc(n,In),t)},Cc=function(n,t){return U(n.all,(function(n){return N(n.cells,(function(n){return In(t,n.element)}))}))},Sc=function(n,t,e){var r=B(t.selection,(function(t){return re(t).bind((function(t){return Cc(n,t)})).filter(e)})),o=Br(r);return Er(0<o.length,o)},Tc=function(n,t,e,r,o){return function(u,i,c,a,l,f){var s=Oe(i);return t(s,c).map((function(t){var e=yc(s,a,!1),r=n(e,t,In,o(a)),u=Se(r.grid);return{info:t,grid:xc(r.grid,a),cursor:r.cursor,lockedColumns:u}})).bind((function(n){var t=vc(i,n.grid),o=S.from(l).getOrThunk((function(){return Ho(i)})),c=S.from(f).getOrThunk(Pu);return e(i,n.grid,n.info,o,c),r(i),Si(u,i),zt(i,xe),0<n.lockedColumns.length&&Mt(i,xe,n.lockedColumns.join(",")),S.some({cursor:n.cursor,newRows:t.newRows,newCells:t.newCells})}))}},Rc=function(n,t){return re(t.element).bind((function(t){return Cc(n,t)}))},Dc=function(n,t){return Sc(n,t,w).map((function(n){return{cells:n,generators:t.generators,clipboard:t.clipboard}}))},Oc=function(n,t){return Sc(n,t,w)},Ac=function(n,t){return Rc(n,t).filter((function(n){return!n.isLocked}))},kc=function(n,t){return Sc(n,t,(function(n){return!n.isLocked}))},Bc=function(n,t){return _(t,(function(t){return Cc(n,t).exists((function(n){return!n.isLocked}))}))},Ec=function(n,t){return t.mergable.filter((function(t){return Bc(n,t.cells)}))},Pc=function(n,t){return t.unmergable.filter((function(t){return Bc(n,t)}))},Ic=function(n,t,e,r){for(var o=ye(n).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<we(o[0]);c++){var a=o[i],l=ve(a,c),f=e(l.element,t);!0===f&&!1===u?pe(a,c,Yn(r(),!0,l.isLocked)):!0===f&&(u=!1)}return n},Mc=function(n){return{is:function(t){return n===t},isValue:w,isError:b,getOr:s(n),getOrThunk:s(n),getOrDie:s(n),or:function(t){return Mc(n)},orThunk:function(t){return Mc(n)},fold:function(t,e){return e(n)},map:function(t){return Mc(t(n))},mapError:function(t){return Mc(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return S.some(n)}}},Nc=function(n){return{is:b,isValue:b,isError:w,getOr:d,getOrThunk:function(n){return n()},getOrDie:function(){return t=String(n),function(){throw new Error(t)}();var t},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return Nc(n)},mapError:function(t){return Nc(t(n))},each:f,bind:function(t){return Nc(n)},exists:b,forall:w,toOptional:S.none}},Wc={value:Mc,error:Nc,fromOption:function(n,t){return n.fold((function(){return Nc(t)}),Mc)}},Lc=function(n,t){return{rowDelta:0,colDelta:we(n[0])-we(t[0])}},zc=function(n,t){return{rowDelta:n.length-t.length,colDelta:0}},_c=function(n,t,e,r){var o="colgroup"===t.section?e.col:e.cell;return k(n,(function(n){return Yn(o(),!0,r(n))}))},jc=function(n,t,e,r){return n.concat(k(t,(function(){var t=n[n.length-1],o=_c(t.cells.length,t,e,(function(n){return Un(r,n.toString())}));return ge(t,o)})))},Fc=function(n,t,e,r){return B(n,(function(n){var o=_c(t,n,e,b);return de(n,r,o)}))},Hc=function(n,t,e){var r=t.colDelta<0?Fc:d,o=t.rowDelta<0?jc:d,u=Se(n),i=we(n[0]),c=A(u,(function(n){return n===i-1})),a=r(n,Math.abs(t.colDelta),e,c?i-1:i),l=Se(a);return o(a,Math.abs(t.rowDelta),e,j(l,w))},qc=function(n,t,e){return P(e,(function(e){return e>=n.column&&e<=we(t[0])+n.column}))},Vc=function(n,t,e,r,o){var u,i,c,a,l,f,s=Se(t),d=(u=n,c=s,a=we((i=t)[0]),l=ye(i).cols.length+u.row,f=k(a-u.column,(function(n){return n+u.column})),{row:l,column:N(f,(function(n){return _(c,(function(t){return t!==n}))})).getOr(a-1)}),p=ye(e).rows,g=qc(d,p,s);return function(n,t,e){if(n.row>=t.length||n.column>we(t[0]))return Wc.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=t.slice(n.row),o=r[0].cells.slice(n.column),u=we(e[0]),i=e.length;return Wc.value({rowDelta:r.length-i,colDelta:o.length-u})}(d,t,p).map((function(n){var e=K(K({},n),{colDelta:n.colDelta-g.length}),u=Hc(t,e,r),i=Se(u),c=qc(d,p,i);return function(n,t,e,r,o,u){for(var i,c,a,l,f,s=n.row,d=n.column,p=s+e.length,g=d+we(e[0])+u.length,h=j(u,w),v=s;v<p;v++)for(var b,y,x,C,S=0,T=d;T<g;T++)h[T]?S++:(a=T,l=void 0,l=m(o,ve((i=t)[c=v],a).element),f=i[c],1<i.length&&1<we(f)&&(0<a&&l(be(f,a-1))||a<f.cells.length-1&&l(be(f,a+1))||0<c&&l(be(i[c-1],a))||c<i.length-1&&l(be(i[c+1],a)))&&Ic(t,be(t[v],T),o,r.cell),b=T-d-S,x=(y=ve(e[v-s],b)).element,C=r.replace(x),pe(t[v],T,Yn(C,!0,y.isLocked)));return t}(d,u,p,r,o,c)}))},Uc=function(n,t,e,r,o){var u,i,c,a;u=t,i=n,c=o,a=r.cell,0<i&&i<u[0].cells.length&&E(u,(function(n){var t=n.cells[i-1],e=n.cells[i];c(e.element,t.element)&&pe(n,i,Yn(a(),!0,e.isLocked))}));var l=zc(e,t),f=Hc(e,l,r),s=zc(t,f),d=Hc(t,s,r);return B(d,(function(t,e){return de(t,n,f[e].cells)}))},Kc=function(n,t,e,r,o){!function(n,t,e,r){var o,u,i,c=ye(n).rows;0<t&&t<c.length&&(o=c[t-1].cells,i=e,u=M(o,(function(n,t){return A(n,(function(n){return i(n.element,t.element)}))?n:n.concat([t])}),[]),E(u,(function(n){for(var o=S.none(),u=t;u<c.length;u++)for(var i=0;i<we(c[0]);i++)!function(t){var i=c[u],a=ve(i,t);e(a.element,n.element)&&(o.isNone()&&(o=S.some(r())),o.each((function(n){pe(i,t,Yn(n,!0,a.isLocked))})))}(i)})))}(t,n,o,r.cell);var u,i,c=Se(t),a=Lc(t,e),l=K(K({},a),{colDelta:a.colDelta-c.length}),f=Hc(t,l,r),s=ye(f),d=s.cols,m=s.rows,p=Se(f),g=Lc(e,t),h=K(K({},g),{colDelta:g.colDelta+p.length}),v=(u=r,i=p,B(e,(function(n){return M(i,(function(t,e){var r=_c(1,n,u,w)[0];return me(t,e,r)}),n)}))),b=Hc(v,h,r);return d.concat(m.slice(0,n)).concat(b).concat(m.slice(n,m.length))},$c=function(n,t,e,r,o){var u=ye(n),i=u.rows,c=u.cols,a=i.slice(0,t),l=i.slice(t),f=he(i[e],(function(n,e){return 0<t&&t<i.length&&r(be(i[t-1],e),be(i[t],e))?ve(i[t],e):Yn(o(n.element,r),!0,n.isLocked)}));return c.concat(a).concat([f]).concat(l)},Gc=function(n,t,e,r,o){return B(n,(function(n){var u=0<t&&t<we(n)&&r(be(n,t-1),be(n,t)),i=function(n,t,e,r,o,u,i){if("colgroup"!==e&&r)return ve(n,t);var c=ve(n,o);return Yn(i(c.element,u),!0,!1)}(n,t,n.section,u,e,r,o);return me(n,t,i)}))},Xc=function(n,t,e,r){return B(n,(function(n){return he(n,(function(n){return o=n,A(t,(function(n){return e(o.element,n.element)}))?Yn(r(n.element,e),!0,n.isLocked):n;var o}))}))},Yc=function(n,t,e,r){return void 0!==be(n[t],e)&&0<t&&r(be(n[t-1],e),be(n[t],e))},Jc=function(n,t,e){return 0<t&&e(be(n,t-1),be(n,t))},Qc=function(n,t,e,r){var o=ye(n).rows,u=z(o,(function(r,o){return Yc(n,o,t,e)||Jc(r,t,e)?[]:[ve(r,t)]}));return Xc(n,u,e,r)},Zc=function(n,t,e,r){var o=ye(n).rows,u=o[t],i=z(u.cells,(function(n,r){return Yc(o,t,r,e)||Jc(u,r,e)?[]:[n]}));return Xc(n,i,e,r)},na=function(n){return M(n,(function(n,t){return A(n,(function(n){return n.column===t.column}))?n:n.concat([t])}),[]).sort((function(n,t){return n.column-t.column}))},ta=function(n){return{element:n,colspan:Gt(n,"colspan",1),rowspan:Gt(n,"rowspan",1)}},ea=function(n){return Lt(n,"scope").map((function(n){return n.substr(0,3)}))},ra=function(n,t){void 0===t&&(t=ta);var e=_o(S.none()),r=function(e){return function(t){switch(Qn(t.element)){case"col":return n.col(t);default:return n.cell(t)}}(t(e))},o=function(n){var t=r(n);return e.get().isNone()&&e.set(S.some(t)),u=S.some({item:n,replacement:t}),t},u=S.none();return{getOrInit:function(n,t){return u.fold((function(){return o(n)}),(function(e){return t(n,e.item)?e.replacement:o(n)}))},cursor:e.get}},oa=function(n,t){return function(e){var r=_o(S.none()),o=[],u=function(u){var i={scope:n},c=e.replace(u,t,i);return o.push({item:u,sub:c}),r.get().isNone()&&r.set(S.some(c)),c};return{replaceOrInit:function(n,t){return"col"===Qn(n)?n:(e=n,r=t,N(o,(function(n){return r(n.item,e)})).fold((function(){return u(n)}),(function(e){return t(n,e.item)?e.sub:u(n)})));var e,r},cursor:r.get}}},ua=function(n){var t=_o(S.none());return{unmerge:function(e){t.get().isNone()&&t.set(S.some(e));var r=ea(e);return r.each((function(n){return Mt(e,"scope",n)})),function(){var t=n.cell({element:e,colspan:1,rowspan:1});return $t(t,"width"),$t(e,"width"),r.each((function(n){return Mt(t,"scope",n)})),t}},merge:function(n){return $t(n[0],"width"),function(){var t=Br(B(n,ea));if(0===t.length)return S.none();var e=t[0],r=["row","col"];return A(t,(function(n){return n!==e&&O(r,n)}))?S.none():S.from(e)}().fold((function(){return zt(n[0],"scope")}),(function(t){return Mt(n[0],"scope",t+"group")})),s(n[0])},cursor:t.get}},ia=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],ca=or(),aa=function(n){return t=n,e=ca.property().name(t),O(ia,e);var t,e},la=function(n){return t=n,e=ca.property().name(t),O(["ol","ul"],e);var t,e},fa=function(n){var t,e=function(n){return"br"===Qn(n)},r=function(n){return Yo(n).bind((function(t){var r=dt(t).map((function(n){return!!aa(n)||!!function(n){return t=n,O(["br","img","hr","input"],ca.property().name(t));var t}(n)&&"img"!==Qn(n)})).getOr(!1);return lt(t).map((function(o){return!0===r||"li"===Qn(u=o)||At(u,la).isSome()||e(t)||aa(o)&&!In(n,o)?[]:[Bn.fromTag("br")];var u}))})).getOr([])},o=0===(t=z(n,(function(n){var t=mt(n);return _(t,(function(n){return e(n)||rt(n)&&0===nr(n).trim().length}))?[]:t.concat(r(n))}))).length?[Bn.fromTag("br")]:t;Ye(n[0]),Xe(n[0],o)},sa=function(n){0===oe(n).length&&Je(n)},da=function(n,t){return{grid:n,cursor:t}},ma=function(n,t,e){var r=ye(n).rows;return pa(r,t,e).orThunk((function(){return pa(r,0,0)}))},pa=function(n,t,e){return S.from(n[t]).bind((function(n){return S.from(n.cells[e]).bind((function(n){return S.from(n.element)}))}))},ga=function(n,t,e){var r=ye(n).rows;return da(n,pa(r,t,e))},ha=function(n){return M(n,(function(n,t){return A(n,(function(n){return n.row===t.row}))?n:n.concat([t])}),[]).sort((function(n,t){return n.row-t.row}))},va=function(n,t,e){var r,o,u=(r=n,o=e.section,le(r,(function(){return o}))),i=Ae(u);return yc(i,t,!0)},ba=function(n,t){var e=P(n,t);return 0===e.length?S.some("td"):e.length===n.length?S.some("th"):S.none()},wa=function(n,t,e,r){var o=Ae(t),u=r.getWidths(o,r);Tu(o,u,r)},ya=function(n,t,e,r,o){var u=Ae(t),i=r.getWidths(u,r),c=r.pixelWidth(),a=o.calcRedestributedWidths(i,c,e.pixelDelta,r.isRelative),l=a.newSizes,f=a.delta;Tu(u,l,r),r.adjustTableWidth(f)},xa=function(n,t){return A(t,(function(n){return 0===n.column&&n.isLocked}))},Ca=function(n,t){return A(t,(function(t){return t.column+t.colspan>=n.grid.columns&&t.isLocked}))},Sa=function(n,t){var e=Wr(n),r=na(t);return M(r,(function(n,t){return n+e[t.column].map(Nr).getOr(0)}),0)},Ta=function(n){return function(t,e){return Oc(t,e).filter((function(e){return!(n?xa:Ca)(t,e)})).map((function(n){return{details:n,pixelDelta:Sa(t,n)}}))}},Ra=function(n){return function(t,e){return Dc(t,e).filter((function(e){return!(n?xa:Ca)(t,e.cells)}))}},Da=Tc((function(n,t,e,r){var o=t[0].row,u=ha(t),i=I(u,(function(n,t){return{grid:$c(n.grid,o,t.row+n.delta,e,r.getOrInit),delta:n.delta+1}}),{grid:n,delta:0}).grid;return ga(i,o,t[0].column)}),Oc,f,f,ra),Oa=Tc((function(n,t,e,r){var o=ha(t),u=o[o.length-1],i=u.row+u.rowspan,c=I(o,(function(n,t){return $c(n,i,t.row,e,r.getOrInit)}),n);return ga(c,i,t[0].column)}),Oc,f,f,ra),Aa=Tc((function(n,t,e,r){var o=t.details,u=na(o),i=u[0].column,c=I(u,(function(n,t){return{grid:Gc(n.grid,i,t.column+n.delta,e,r.getOrInit),delta:n.delta+1}}),{grid:n,delta:0}).grid;return ga(c,o[0].row,i)}),Ta(!0),ya,f,ra),ka=Tc((function(n,t,e,r){var o=t.details,u=o[o.length-1],i=u.column+u.colspan,c=na(o),a=I(c,(function(n,t){return Gc(n,i,t.column,e,r.getOrInit)}),n);return ga(a,o[0].row,i)}),Ta(!1),ya,f,ra),Ba=Tc((function(n,t,e,r){var o,u,i=na(t.details),c=(o=n,u=B(i,(function(n){return n.column})),z(o,(function(n){var t=n.cells,e=I(u,(function(n,t){return 0<=t&&t<n.length?n.slice(0,t).concat(n.slice(t+1)):n}),t);return 0<e.length?[Jn(e,n.section)]:[]}))),a=ma(c,i[0].row,i[0].column);return da(c,a)}),(function(n,t){return kc(n,t).map((function(t){return{details:t,pixelDelta:-Sa(n,t)}}))}),ya,sa,ra),Ea=Tc((function(n,t,e,r){var o,u,i,c,a,l=ha(t),f=(o=n,u=l[0].row,i=l[l.length-1].row,a=(c=ye(o)).rows,c.cols.concat(a.slice(0,u)).concat(a.slice(i+1))),s=ma(f,t[0].row,t[0].column);return da(f,s)}),Oc,f,sa,ra),Pa=(Tc((function(n,t,e,r){var o=Qc(n,t.column,e,r.replaceOrInit);return ga(o,t.row,t.column)}),Ac,f,f,oa("row","th")),Tc((function(n,t,e,r){var o=na(t),u=M(o,(function(n,t){return Qc(n,t.column,e,r.replaceOrInit)}),n);return ga(u,t[0].row,t[0].column)}),kc,f,f,oa("row","th"))),Ia=(Tc((function(n,t,e,r){var o=Qc(n,t.column,e,r.replaceOrInit);return ga(o,t.row,t.column)}),Ac,f,f,oa(null,"td")),Tc((function(n,t,e,r){var o=na(t),u=M(o,(function(n,t){return Qc(n,t.column,e,r.replaceOrInit)}),n);return ga(u,t[0].row,t[0].column)}),kc,f,f,oa(null,"td"))),Ma=(Tc((function(n,t,e,r){var o=Zc(n,t.row,e,r.replaceOrInit);return ga(o,t.row,t.column)}),Rc,f,f,oa("col","th")),Tc((function(n,t,e,r){var o=ha(t),u=M(o,(function(n,t){return Zc(n,t.row,e,r.replaceOrInit)}),n);return ga(u,t[0].row,t[0].column)}),Oc,f,f,oa("col","th")),Tc((function(n,t,e,r){var o=Zc(n,t.row,e,r.replaceOrInit);return ga(o,t.row,t.column)}),Rc,f,f,oa(null,"td")),Tc((function(n,t,e,r){var o=ha(t),u=M(o,(function(n,t){return Zc(n,t.row,e,r.replaceOrInit)}),n);return ga(u,t[0].row,t[0].column)}),Oc,f,f,oa(null,"td")),Tc((function(n,t,e,r){var o=t.cells;fa(o);var u=function(n,t,e){var r=ye(n).rows;if(0===r.length)return n;for(var o=t.startRow;o<=t.finishRow;o++)for(var u=t.startCol;u<=t.finishCol;u++){var i=r[o],c=ve(i,u).isLocked;pe(i,u,Yn(e(),!1,c))}return n}(n,t.bounds,r.merge(o));return da(u,S.from(o[0]))}),Ec,wa,f,ua)),Na=Tc((function(n,t,e,r){var o=I(t,(function(n,t){return Ic(n,t,e,r.unmerge(t))}),n);return da(o,S.from(t[0]))}),Pc,wa,f,ua),Wa=Tc((function(n,t,e,r){var o,u,i,c=(o=t.clipboard,u=t.generators,i=Oe(o),yc(i,u,!0)),a={row:t.row,column:t.column};return Vc(a,n,c,t.generators,e).fold((function(){return da(n,S.some(t.element))}),(function(n){var e=ma(n,t.row,t.column);return da(n,e)}))}),(function(n,t){return re(t.element).bind((function(e){return Cc(n,e).map((function(n){return K(K({},n),{generators:t.generators,clipboard:t.clipboard})}))}))}),wa,f,ra),La=Tc((function(n,t,e,r){var o=ye(n).rows,u=t.cells[0].column,i=o[t.cells[0].row],c=va(t.clipboard,t.generators,i),a=Uc(u,n,c,t.generators,e),l=ma(a,t.cells[0].row,t.cells[0].column);return da(a,l)}),Ra(!0),f,f,ra),za=Tc((function(n,t,e,r){var o=ye(n).rows,u=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,i=o[t.cells[0].row],c=va(t.clipboard,t.generators,i),a=Uc(u,n,c,t.generators,e),l=ma(a,t.cells[0].row,t.cells[0].column);return da(a,l)}),Ra(!1),f,f,ra),_a=Tc((function(n,t,e,r){var o=ye(n).rows,u=t.cells[0].row,i=o[u],c=va(t.clipboard,t.generators,i),a=Kc(u,n,c,t.generators,e),l=ma(a,t.cells[0].row,t.cells[0].column);return da(a,l)}),Dc,f,f,ra),ja=Tc((function(n,t,e,r){var o=ye(n).rows,u=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,i=o[t.cells[0].row],c=va(t.clipboard,t.generators,i),a=Kc(u,n,c,t.generators,e),l=ma(a,t.cells[0].row,t.cells[0].column);return da(a,l)}),Dc,f,f,ra),Fa=function(n,t){var e=Oe(n);return Oc(e,t).bind((function(n){var t=n[n.length-1],r=n[0].column,o=t.column+t.colspan,u=L(B(e.all,(function(n){return P(n.cells,(function(n){return n.column>=r&&n.column<o}))})));return ba(u,(function(n){return"th"===Qn(n.element)}))})).getOr("")},Ha=function(n){return au(n.parentNode)},qa=function(n,t){var e="thead"===Ha(t),r=!A(t.cells,(function(n){return"th"!==au(n)}));return e||r?S.some({thead:e,ths:r}):S.none()},Va=function(n,t){return"thead"===(e=qa(0,t).fold((function(){return Ha(t)}),(function(n){return"thead"})))?"header":"tfoot"===e?"footer":"body";var e},Ua=function(n,t,e){var r,o,u=n.getParent(t,"table"),i=t.parentNode,c=au(i);e!==c&&((r=n.select(e,u)[0])||(r=n.create(e),o=u.firstChild,"thead"===e?V(St(Bn.fromDom(u),"caption,colgroup")).fold((function(){return u.insertBefore(r,o)}),(function(t){return n.insertAfter(r,t.dom)})):u.appendChild(r)),"tbody"===e&&"thead"===c&&r.firstChild?r.insertBefore(t,r.firstChild):r.appendChild(t),i.hasChildNodes()||n.remove(i))},Ka=function(n,t,e,r){var o=n.dom,u=function(n,t,e){if(c(e)&&au(t)!==e){var r=n.dom.rename(t,e);return Ei(n,r),r}return t}(n,t,e);return i(r)||o.setAttrib(u,"scope",r),u},$a=function(n,t,e,r){return E(t,(function(t){return Ka(n,t,e,r)}))},Ga=function(n,t,e){var r,o,u,i=n.dom;"header"===e?(o="auto"===(r=Xi(n))?(u=ie(Bn.fromDom(t.cells[0])).map(ce).getOr([]),U(u,(function(n){return qa(0,n.dom)})).map((function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"})).getOr("section")):r,$a(n,t.cells,"section"===o?"td":"th","col"),Ua(i,t,"cells"===o?"tbody":"thead")):($a(n,t.cells,"td",null),Ua(i,t,"footer"===e?"tfoot":"tbody"))},Xa=function(n){return function(t,e){var r,o=Qn(t),u="col"===o||"colgroup"===o?ie(r=t).bind((function(n){return br(n,wu.firstSelectedSelector)})).fold((function(){return r}),(function(n){return n[0]})):t;return Pt(u,n,e)}},Ya=Xa("th,td"),Ja=Xa("th,td,caption"),Qa=function(n,t,e){return Ya(n,e).map((function(n){return bu(t)})).getOr([])},Za=function(n,t){var e,r,o,u=Ya(n);return r=u.bind((function(n){return ie(n)})).map(ce),o=function(n,e){return P(e,(function(e){return A(cu(e.dom.cells),(function(e){return"1"===Wt(e,t)||In(e,n)}))}))},((e=u).isSome()&&r.isSome()?S.some(o(e.getOrDie(),r.getOrDie())):S.none()).getOr([])},nl={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},tl=function(n,t,e,r){return k(n,(function(n){return function(n,t,e,r){for(var o=Bn.fromTag("tr"),u=0;u<n;u++){var i=Bn.fromTag(r<t||u<e?"th":"td");u<e&&Mt(i,"scope","row"),r<t&&Mt(i,"scope","col"),Ke(i,Bn.fromTag("br")),Ke(o,i)}return o}(t,e,r,n)}))},el=function(n,t){n.selection.select(t.dom,!0),n.selection.collapse(!0)},rl=function(n,t,r,o,u){var i=Fi(n),c={styles:i,attributes:ji(n),colGroups:n.getParam("table_use_colgroups",!1,"boolean")};return n.undoManager.ignore((function(){var e=function(n,t,e,r,o,u){void 0===u&&(u=nl);var i=Bn.fromTag("table"),c="cells"!==o;qt(i,u.styles),Nt(i,u.attributes),u.colGroups&&Ke(i,function(n){var t=Bn.fromTag("colgroup");return k(n,(function(){return Ke(t,Bn.fromTag("col"))})),t}(t));var a,l,f=Math.min(n,e);c&&0<e&&(a=Bn.fromTag("thead"),Ke(i,a),l=tl(e,t,"sectionCells"===o?f:0,r),Xe(a,l));var s=Bn.fromTag("tbody");Ke(i,s);var d=tl(c?n-f:n,t,c?0:e,r);return Xe(s,d),i}(r,t,u,o,Xi(n),c);Mt(e,"data-mce-id","__mce");var i,a,l,f=(i=e,a=Bn.fromTag("div"),l=Bn.fromDom(i.dom.cloneNode(!0)),Ke(a,l),a.dom.innerHTML);n.insertContent(f),n.addVisual()})),Et(lu(n),'table[data-mce-id="__mce"]').map((function(t){var r,o,u;return $i(n)?rc(n,t):Gi(n)?oc(t):(Ki(n)||(r=i.width,e(r)&&-1!==r.indexOf("%")))&&ec(n,t),pu(t),zt(t,"data-mce-id"),o=n,E(Tt(t,"tr"),(function(n){Bi(o,n.dom),E(Tt(n,"th,td"),(function(n){Ei(o,n.dom)}))})),u=n,Et(t,"td,th").each(m(el,u)),t.dom})).getOr(null)},ol=function(n,t,e,r,o){void 0===r&&(r={});var u=function(n){return l(n)&&0<n};if(u(t)&&u(e)){var i=r.headerRows||0,c=r.headerColumns||0;return rl(n,e,t,c,i)}return console.error(o),null},ul=function(n){return function(){return n().fold((function(){return[]}),(function(n){return B(n,(function(n){return n.dom}))}))}},il=function(n){return function(t){var e=0<t.length?S.some(cu(t)):S.none();n(e)}},cl=function(n,t,e){var r=Gt(n,t,1);1===e||r<=1?zt(n,t):Mt(n,t,Math.min(e,r))},al=tinymce.util.Tools.resolve("tinymce.util.Tools"),ll=function(n,t,e){return function(t,r){for(var o=0;o<r.length;o++){var u=n.getStyle(r[o],e);if(void 0===t&&(t=u),t!==u)return""}return t}(void 0,n.select("td,th",t))},fl=function(n,t,e){e&&n.formatter.apply("align"+e,{},t)},sl=function(n,t){al.each("left center right".split(" "),(function(e){n.formatter.remove("align"+e,{},t)}))},dl=function(n,t){return(t||[]).concat(B(n,(function(n){var t=n.text||n.title;return Kn(n,"menu")?{text:t,items:dl(n.menu)}:{text:t,value:n.value}})))},ml=function(n){return function(t){return rn(t,"rgb")?n.toHex(t):t}},pl=function(n,t){var e=Bn.fromDom(t);return{borderwidth:Kt(e,"border-width").getOr(""),borderstyle:Kt(e,"border-style").getOr(""),bordercolor:Kt(e,"border-color").map(ml(n)).getOr(""),backgroundcolor:Kt(e,"background-color").map(ml(n)).getOr("")}},gl=function(n){var t=n[0],e=n.slice(1);return E(e,(function(n){E(Wn(t),(function(e){zn(n,(function(n,r){var o=t[e];""!==o&&e===r&&o!==n&&(t[e]="")}))}))})),t},hl=function(n){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},vl=function(n,t,e,r){return N(n,(function(n){return e.formatter.matchNode(r,t+n)})).getOr("")},bl=m(vl,["left","center","right"],"align"),wl=m(vl,["top","middle","bottom"],"valign"),yl=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],xl=function(n){return yl.concat((0<(t=dl(n.getParam("table_cell_class_list",[],"array"))).length?S.some({name:"class",type:"listbox",label:"Class",items:t}):S.none()).toArray());var t},Cl=function(n){return function(t,e){var r=t.dom;return{setAttrib:function(t,o){n&&!o||r.setAttrib(e,t,o)},setStyle:function(t,o){n&&!o||r.setStyle(e,t,o)},setFormat:function(r,o){n&&!o||(""===o?t.formatter.remove(r,{value:null},e,!0):t.formatter.apply(r,{value:o},e))}}}},Sl={normal:Cl(!1),ifTruthy:Cl(!0)},Tl=function(n){return ie(n[0]).map((function(t){var e=Oe(t),r=Pe(e),o=P(r,(function(t){return A(n,(function(n){return In(t.element,n)}))}));return B(o,(function(n){return{element:n.element.dom,column:Ne(e,n.column).map((function(n){return n.element.dom}))}}))}))},Rl=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){(function(n,t,e,r){var o,u,i=1===t.length,c=Fn(r,(function(n,t){return e[t]!==n}));0<qn(c)&&1<=t.length&&(o=ie(t[0]),Tl(t).each((function(t){E(t,(function(t){var e,o,u,c,a,l,f,s,d,m,p=Ka(n,t.element,r.celltype),g=i?Sl.normal(n,p):Sl.ifTruthy(n,p);o=t.column.map((function(t){return i?Sl.normal(n,t):Sl.ifTruthy(n,t)})).getOr(g),u=r,(e=g).setAttrib("scope",u.scope),e.setAttrib("class",u.class),e.setStyle("height",mu(u.height)),o.setStyle("width",mu(u.width)),Hi(n)&&(a=r,(c=g).setFormat("tablecellbackgroundcolor",a.backgroundcolor),c.setFormat("tablecellbordercolor",a.bordercolor),c.setFormat("tablecellborderstyle",a.borderstyle),c.setFormat("tablecellborderwidth",mu(a.borderwidth))),i&&(sl(n,p),l=n,f=p,al.each("top middle bottom".split(" "),(function(n){l.formatter.remove("valign"+n,{},f)}))),r.halign&&fl(n,p,r.halign),r.valign&&(s=n,d=p,(m=r.valign)&&s.formatter.apply("valign"+m,{},d))}))})),u=0<qn(Fn(c,(function(n,t){return"scope"!==t&&"celltype"!==t}))),o.each((function(t){return Pi(n,t.dom,{structure:Un(c,"celltype"),style:u})})))})(n,t,e,o),n.focus()}))},Dl=function(n,t){var e,r,o,u=Qa(vu(n),t);0!==u.length&&(e=function(n,t){var e=Tl(t).map((function(t){return B(t,(function(t){return e=n,r=t.element,o=Hi(n),u=t.column,i=e.dom,c=u.getOr(r),K({width:(a=function(n,t){return i.getStyle(n,t)||i.getAttrib(n,t)})(c,"width"),height:a(r,"height"),scope:i.getAttrib(r,"scope"),celltype:au(r),class:i.getAttrib(r,"class",""),halign:bl(e,r),valign:wl(e,r)},o?pl(i,r):{});var e,r,o,u,i,c,a}))}));return gl(e.getOrDie())}(n,u),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:xl(n)},hl("cell")]},o={type:"panel",items:[{type:"grid",columns:2,items:xl(n)}]},n.windowManager.open({title:"Cell Properties",size:"normal",body:Hi(n)?r:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:e,onSubmit:m(Rl,n,u,e)}))},Ol=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Al=function(n){return Ol.concat((0<(t=dl(n.getParam("table_row_class_list",[],"array"))).length?S.some({name:"class",type:"listbox",label:"Class",items:t}):S.none()).toArray());var t},kl=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){(function(n,t,e,r){var o,u,i=1===t.length,c=Fn(r,(function(n,t){return e[t]!==n}));0<qn(c)&&(E(t,(function(t){r.type!==au(t.parentNode)&&Ga(n,t,r.type);var o,u,c,a,l=i?Sl.normal(n,t):Sl.ifTruthy(n,t);u=r,(o=l).setAttrib("class",u.class),o.setStyle("height",mu(u.height)),qi(n)&&(a=r,(c=l).setStyle("background-color",a.backgroundcolor),c.setStyle("border-color",a.bordercolor),c.setStyle("border-style",a.borderstyle)),r.align!==e.align&&(sl(n,t),fl(n,t,r.align))})),o=Un(c,"type"),u=!o||1<qn(c),ie(Bn.fromDom(t[0])).each((function(t){return Pi(n,t.dom,{structure:o,style:u})})))})(n,t,e,o),n.focus()}))},Bl=function(n){var t,e,r,o,u=Za(vu(n),wu.selected);0!==u.length&&(t=B(u,(function(t){return e=n,r=t.dom,o=qi(n),u=e.dom,K({height:u.getStyle(r,"height")||u.getAttrib(r,"height"),class:u.getAttrib(r,"class",""),type:Va(0,r),align:bl(e,r)},o?pl(u,r):{});var e,r,o,u})),e=gl(t),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:Al(n)},hl("row")]},o={type:"panel",items:[{type:"grid",columns:2,items:Al(n)}]},n.windowManager.open({title:"Row Properties",size:"normal",body:qi(n)?r:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:e,onSubmit:m(kl,n,B(u,(function(n){return n.dom})),e)}))},El=tinymce.util.Tools.resolve("tinymce.Env"),Pl=function(n,t,r,o){if("TD"===t.tagName||"TH"===t.tagName)e(r)?n.setStyle(t,r,o):n.setStyle(t,r);else if(t.children)for(var u=0;u<t.children.length;u++)Pl(n,t.children[u],r,o)},Il=function(n,t,e,r){var o,u=n.dom,i=r.getData(),c=Fn(i,(function(n,t){return e[t]!==n}));r.close(),""===i.class&&delete i.class,n.undoManager.transact((function(){var e,r,a,l;t||(e=parseInt(i.cols,10)||1,r=parseInt(i.rows,10)||1,t=rl(n,e,r,0,0)),0<qn(c)&&(function(n,t,e){var r,o=n.dom,u={},i={};if(u.class=e.class,i.height=mu(e.height),o.getAttrib(t,"width")&&!Ui(n)?u.width=(r=e.width)?r.replace(/px$/,""):"":i.width=mu(e.width),Ui(n)?(i["border-width"]=mu(e.border),i["border-spacing"]=mu(e.cellspacing)):(u.border=e.border,u.cellpadding=e.cellpadding,u.cellspacing=e.cellspacing),Ui(n)&&t.children)for(var c=0;c<t.children.length;c++)Pl(o,t.children[c],{"border-width":mu(e.border),padding:mu(e.cellpadding)}),Vi(n)&&Pl(o,t.children[c],{"border-color":e.bordercolor});Vi(n)&&(i["background-color"]=e.backgroundcolor,i["border-color"]=e.bordercolor,i["border-style"]=e.borderstyle),u.style=o.serializeStyle(K(K({},Fi(n)),i)),o.setAttribs(t,K(K({},ji(n)),u))}(n,t,i),(o=u.select("caption",t)[0])&&!i.caption&&u.remove(o),!o&&i.caption&&((o=u.create("caption")).innerHTML=El.ie?" ":'<br data-mce-bogus="1"/>',t.insertBefore(o,t.firstChild)),""===i.align?sl(n,t):fl(n,t,i.align)),n.focus(),n.addVisual(),0<qn(c)&&(l=!(a=Un(c,"caption"))||1<qn(c),Pi(n,t,{structure:a,style:l}))}))},Ml=function(n,t){var e,r,o,u,i,c,a,l,f=n.dom,s=function(n,t){var e,r,o,u,i=Fi(n),c=ji(n),a=t?(e=n.dom,{borderstyle:Vn(i,"border-style").getOr(""),bordercolor:ml(e)(Vn(i,"border-color").getOr("")),backgroundcolor:ml(e)(Vn(i,"background-color").getOr(""))}):{};return K(K(K(K(K(K({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),i),c),a),(u=i["border-width"],Ui(n)&&u?{border:u}:Vn(c,"border").fold((function(){return{}}),(function(n){return{border:n}})))),(r=Vn(i,"border-spacing").or(Vn(c,"cellspacing")).fold((function(){return{}}),(function(n){return{cellspacing:n}})),o=Vn(i,"border-padding").or(Vn(c,"cellpadding")).fold((function(){return{}}),(function(n){return{cellpadding:n}})),K(K({},r),o)))}(n,Vi(n));!1===t?(e=f.getParent(n.selection.getStart(),"table",n.getBody()))?(o=e,u=Vi(r=n),l=r.dom,s=K({width:l.getStyle(o,"width")||l.getAttrib(o,"width"),height:l.getStyle(o,"height")||l.getAttrib(o,"height"),cellspacing:l.getStyle(o,"border-spacing")||l.getAttrib(o,"cellspacing"),cellpadding:l.getAttrib(o,"cellpadding")||ll(r.dom,o,"padding"),border:(i=l,c=o,a=Kt(Bn.fromDom(c),"border-width"),Ui(r)&&a.isSome()?a.getOr(""):i.getAttrib(c,"border")||ll(r.dom,c,"border-width")||ll(r.dom,c,"border")),caption:!!l.select("caption",o)[0],class:l.getAttrib(o,"class",""),align:bl(r,o)},u?pl(l,o):{})):Vi(n)&&(s.borderstyle="",s.bordercolor="",s.backgroundcolor=""):(s.cols="1",s.rows="1",Vi(n)&&(s.borderstyle="",s.bordercolor="",s.backgroundcolor=""));var d=dl(n.getParam("table_class_list",[],"array"));0<d.length&&s.class&&(s.class=s.class.replace(/\s*mce\-item\-table\s*/g,""));var p,g,h,v,b={type:"grid",columns:2,items:(p=d,g=t?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],h=n.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],v=0<p.length?[{type:"listbox",name:"class",label:"Class",items:p}]:[],g.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(h).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(v))},w=Vi(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[b]},hl("table")]}:{type:"panel",items:[b]};n.windowManager.open({title:"Table Properties",size:"normal",body:w,onSubmit:m(Il,n,e,s),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:s})},Nl=function(n){return Ja(vu(n),du(n))},Wl=function(n){return Ya(vu(n),du(n))},Ll=function(n,t,o,u,i){var c=du(n),a=function(n){return ie(n,c)},l=function(t){return function(e){n.selection.setRng(e.rng),n.focus(),o.clear(t),pu(t),Pi(n,t.dom,e.effect)}},s=function(t){return Wl(n).each((function(n){a(n).each((function(e){var r=yu(u,e,n);t(e,r).each(l(e))}))}))},d=function(){return Wl(n).map((function(t){return a(t).bind((function(e){return function(n,t,e){var r=Oe(n);return Oc(r,t).bind((function(n){var t=yc(r,e,!1),o=ye(t).rows.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan),u=z(o,(function(n){var t=P(n.cells,(function(n){return!n.isLocked}));return 0<t.length?[K(K({},n),{cells:t})]:[]})),i=xc(u,e);return Er(0<i.length,i)})).map((function(n){return B(n,(function(n){var t=Ar(n.element);return E(n.cells,(function(n){var e=kr(n.element);gc(e,"colspan",n.colspan,1),gc(e,"rowspan",n.rowspan,1),Ke(t,e)})),t}))}))}(e,yu(u,e,t),uu(f,Bn.fromDom(n.getDoc()),S.none()))}))}))},p=function(){return Wl(n).map((function(n){return a(n).bind((function(t){return function(n,t){var e=Oe(n);return kc(e,t).map((function(n){var t,r,o=n[n.length-1],u=n[0].column,i=o.column+o.colspan;return $(function(n,t,e){if(Me(n)){var r=P(Ie(n),(function(n){return n.column>=t&&n.column<e})),o=B(r,(function(n){var r=kr(n.element);return cl(r,"span",e-t),r})),u=Bn.fromTag("colgroup");return Xe(u,o),[u]}return[]}(e,u,i),(t=u,r=i,B(e.all,(function(n){var e=P(n.cells,(function(n){return n.column>=t&&n.column<r})),o=B(e,(function(n){var e=kr(n.element);return cl(e,"colspan",r-t),e})),u=Bn.fromTag("tr");return Xe(u,o),u}))))}))}(t,yu(u,t,n))}))}))},g=function(t,e){return e().each((function(e){var r=B(e,kr);Wl(n).each((function(e){return a(e).each((function(e){var o,i,c=iu(Bn.fromDom(n.getDoc())),a=(o=r,i=c,{selection:bu(u),clipboard:o,generators:i});t(e,a).each(l(e))}))}))}))};zn({mceTableSplitCells:function(){return s(t.unmergeCells)},mceTableMergeCells:function(){return s(t.mergeCells)},mceTableInsertRowBefore:function(){return s(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(t.insertRowsAfter)},mceTableInsertColBefore:function(){return s(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(t.insertColumnsAfter)},mceTableDeleteCol:function(){return s(t.deleteColumn)},mceTableDeleteRow:function(){return s(t.deleteRow)},mceTableCutCol:function(n){return p().each((function(n){i.setColumns(n),s(t.deleteColumn)}))},mceTableCutRow:function(n){return d().each((function(n){i.setRows(n),s(t.deleteRow)}))},mceTableCopyCol:function(n){return p().each((function(n){return i.setColumns(n)}))},mceTableCopyRow:function(n){return d().each((function(n){return i.setRows(n)}))},mceTablePasteColBefore:function(n){return g(t.pasteColsBefore,i.getColumns)},mceTablePasteColAfter:function(n){return g(t.pasteColsAfter,i.getColumns)},mceTablePasteRowBefore:function(n){return g(t.pasteRowsBefore,i.getRows)},mceTablePasteRowAfter:function(n){return g(t.pasteRowsAfter,i.getRows)},mceTableDelete:function(){return Nl(n).each((function(t){ie(t,c).filter(v(c)).each((function(t){var e,r=Bn.fromText("");Ve(t,r),Je(t),n.dom.isEmpty(n.getBody())?(n.setContent(""),n.selection.setCursorLocation()):((e=n.dom.createRng()).setStart(r.dom,0),e.setEnd(r.dom,0),n.selection.setRng(e),n.nodeChanged())}))}))},mceTableSizingMode:function(t,e){return r=e,Nl(n).each((function(t){Gi(n)||$i(n)||Ki(n)||ie(t,c).each((function(t){"relative"!==r||qu(t)?"fixed"!==r||Vu(t)?"responsive"!==r||Uu(t)||oc(t):rc(n,t):ec(n,t),pu(t),Pi(n,t.dom,Mi)}))}));var r}},(function(t,e){return n.addCommand(e,t)}));var h=function(n,t){t.each((function(t){Pi(n,t.dom,Mi)}))};zn({mceTableCellType:function(e,r){var o=ie(vu(n),c);t.setTableCellType(n,r),h(n,o)},mceTableRowType:function(e,r){var o=ie(vu(n),c);t.setTableRowType(n,r),h(n,o)}},(function(t,e){return n.addCommand(e,t)})),n.addCommand("mceTableColType",(function(n,e){return Vn(e,"type").each((function(n){return s("th"===n?t.makeColumnsHeader:t.unmakeColumnsHeader)}))})),zn({mceTableProps:m(Ml,n,!1),mceTableRowProps:m(Bl,n),mceTableCellProps:m(Dl,n,u)},(function(t,e){return n.addCommand(e,(function(){return t()}))})),n.addCommand("mceInsertTable",(function(t,e){r(e)&&0<Wn(e).length?ol(n,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Ml(n,!0)})),n.addCommand("mceTableApplyCellStyle",(function(t,o){var i,l,f=function(n){return"tablecell"+n.toLowerCase().replace("-","")};!r(o)||0!==(i=Qa(vu(n),u,c)).length&&(function(n){for(var t in n)if(Ln.call(n,t))return!1;return!0}(l=Fn(o,(function(t,r){return n.formatter.has(f(r))&&e(t)})))||(zn(l,(function(t,e){E(i,(function(r){Sl.normal(n,r.dom).setFormat(f(e),t)}))})),a(i[0]).each((function(t){return Pi(n,t.dom,Ii)}))))}))},zl={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},_l=yr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),jl=K(K({},_l),{none:function(n){return void 0===n&&(n=void 0),_l.none(n)}}),Fl=function(n,t){return ie(n,t).bind((function(t){var e=oe(t);return W(e,(function(t){return In(n,t)})).map((function(n){return{index:n,all:e}}))}))},Hl=function(n,t,e,r){return{start:n,soffset:t,finish:e,foffset:r}},ql=yr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Vl={before:ql.before,on:ql.on,after:ql.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(d,d,d)}},Ul=yr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Kl={domRange:Ul.domRange,relative:Ul.relative,exact:Ul.exact,exactFromRange:function(n){return Ul.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var t=n.match({domRange:function(n){return Bn.fromDom(n.startContainer)},relative:function(n,t){return Vl.getStart(n)},exact:function(n,t,e,r){return n}});return Bn.fromDom(at(t).dom.defaultView)},range:Hl},$l=function(n,t,e){var r,o,u=n.document.createRange();return r=u,t.fold((function(n){r.setStartBefore(n.dom)}),(function(n,t){r.setStart(n.dom,t)}),(function(n){r.setStartAfter(n.dom)})),o=u,e.fold((function(n){o.setEndBefore(n.dom)}),(function(n,t){o.setEnd(n.dom,t)}),(function(n){o.setEndAfter(n.dom)})),u},Gl=function(n,t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom,e),u.setEnd(r.dom,o),u},Xl=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Yl=yr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Jl=function(n,t,e){return t(Bn.fromDom(e.startContainer),e.startOffset,Bn.fromDom(e.endContainer),e.endOffset)},Ql=function(n,t){var e,r,o,u=(e=n,t.match({domRange:function(n){return{ltr:s(n),rtl:S.none}},relative:function(n,t){return{ltr:X((function(){return $l(e,n,t)})),rtl:X((function(){return S.some($l(e,t,n))}))}},exact:function(n,t,r,o){return{ltr:X((function(){return Gl(e,n,t,r,o)})),rtl:X((function(){return S.some(Gl(e,r,o,n,t))}))}}}));return(o=(r=u).ltr()).collapsed?r.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Yl.rtl(Bn.fromDom(n.endContainer),n.endOffset,Bn.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return Jl(0,Yl.ltr,o)})):Jl(0,Yl.ltr,o)},Zl=function(n,t){return Ql(n,t).match({ltr:function(t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom,e),u.setEnd(r.dom,o),u},rtl:function(t,e,r,o){var u=n.document.createRange();return u.setStart(r.dom,o),u.setEnd(t.dom,e),u}})},nf=(Yl.ltr,Yl.rtl,function(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}),tf=function(n,t,e,r){return rt(t)?function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getClientRects();return U(u,(function(n){return nf(n,e,r)?S.some(n):S.none()})).map((function(o){return function(n,t,e,r,o){var u=function(e){var r=n.dom.createRange();return r.setStart(t.dom,e),r.collapse(!0),r},i=nr(t).length,c=function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),a=Math.abs(t-c.left);if(e<=c.bottom){if(e<c.top||u<a)return i-1;u=a}}return 0}((function(n){return u(n).getBoundingClientRect()}),e,r,o.right,i);return u(c)}(n,t,e,r,o)}))}(n,t,e,r):(u=t,i=e,c=r,a=(o=n).dom.createRange(),l=mt(u),U(l,(function(n){return a.selectNode(n.dom),nf(a.getBoundingClientRect(),i,c)?tf(o,n,i,c):S.none()})));var o,u,i,c,a,l},ef=function(n,t){return t-n.left<n.right-t},rf=function(n,t,e){var r=n.dom.createRange();return r.selectNode(t.dom),r.collapse(e),r},of=function(n,t,e){var r=n.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),u=ef(o,e);return(!0===u?Xo:Yo)(t).map((function(t){return rf(n,t,u)}))},uf=function(n,t,e){var r=t.dom.getBoundingClientRect(),o=ef(r,e);return S.some(rf(n,t,o))},cf=document.caretPositionFromPoint?function(n,t,e){return S.from(n.dom.caretPositionFromPoint(t,e)).bind((function(t){if(null===t.offsetNode)return S.none();var e=n.dom.createRange();return e.setStart(t.offsetNode,t.offset),e.collapse(),S.some(e)}))}:document.caretRangeFromPoint?function(n,t,e){return S.from(n.dom.caretRangeFromPoint(t,e))}:function(n,t,e){return Bn.fromPoint(n,t,e).bind((function(r){var o=function(){return e=n,u=t,(0===mt(o=r).length?uf:of)(e,o,u);var e,o,u};return 0===mt(r).length?o():function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getBoundingClientRect();return function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,e)),c=Math.max(u.top,Math.min(u.bottom,r));return tf(n,t,i,c)}(n,t,Math.max(u.left,Math.min(u.right,e)),Math.max(u.top,Math.min(u.bottom,r)))}(n,r,t,e).orThunk(o)}))},af=function(n,t){var e=Qn(n);return"input"===e?Vl.after(n):O(["br","img"],e)?0===t?Vl.before(n):Vl.after(n):Vl.on(n,t)},lf=function(n,t){var e=n.fold(Vl.before,af,Vl.after),r=t.fold(Vl.before,af,Vl.after);return Kl.relative(e,r)},ff=function(n,t,e,r){var o=af(n,t),u=af(e,r);return Kl.relative(o,u)},sf=function(n){return S.from(n.getSelection())},df=function(n,t){sf(n).each((function(n){n.removeAllRanges(),n.addRange(t)}))},mf=function(n,t,e,r,o){var u=Gl(n,t,e,r,o);df(n,u)},pf=function(n,t){return Ql(n,t).match({ltr:function(t,e,r,o){mf(n,t,e,r,o)},rtl:function(t,e,r,o){sf(n).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(t.dom,e,r.dom,o);else if(u.extend)try{c=t,a=e,l=r,f=o,(i=u).collapse(c.dom,a),i.extend(l.dom,f)}catch(u){mf(n,r,o,t,e)}else mf(n,r,o,t,e);var i,c,a,l,f}))}})},gf=function(n,t,e,r,o){var u=ff(t,e,r,o);pf(n,u)},hf=function(n,t,e){var r=lf(t,e);pf(n,r)},vf=function(n){if(0<n.rangeCount){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return S.some(Hl(Bn.fromDom(t.startContainer),t.startOffset,Bn.fromDom(e.endContainer),e.endOffset))}return S.none()},bf=function(n){if(null===n.anchorNode||null===n.focusNode)return vf(n);var t=Bn.fromDom(n.anchorNode),e=Bn.fromDom(n.focusNode);return function(n,t,e,r){var o,u,i,c,a,l=(u=t,i=e,c=r,(a=ct(o=n).dom.createRange()).setStart(o.dom,u),a.setEnd(i.dom,c),a),f=In(n,e)&&t===r;return l.collapsed&&!f}(t,n.anchorOffset,e,n.focusOffset)?S.some(Hl(t,n.anchorOffset,e,n.focusOffset)):vf(n)},wf=function(n){return sf(n).filter((function(n){return 0<n.rangeCount})).bind(bf).map((function(n){return Kl.exact(n.start,n.soffset,n.finish,n.foffset)}))},yf=tinymce.util.Tools.resolve("tinymce.util.VK"),xf=function(n,t,e){return Tf(n,t,Fl(r=e,undefined).fold((function(){return jl.none(r)}),(function(n){return n.index+1<n.all.length?jl.middle(r,n.all[n.index+1]):jl.last(r)})));var r},Cf=function(n,t,e){return Tf(n,t,Fl(r=e,undefined).fold((function(){return jl.none()}),(function(n){return 0<=n.index-1?jl.middle(r,n.all[n.index-1]):jl.first(r)})));var r},Sf=function(n,t){return function(n){var t=Kl.getWin(n).dom,e=function(n,e,r,o){return Gl(t,n,e,r,o)},r=n.match({domRange:function(n){var t=Bn.fromDom(n.startContainer),e=Bn.fromDom(n.endContainer);return ff(t,n.startOffset,e,n.endOffset)},relative:lf,exact:ff});return Ql(t,r).match({ltr:e,rtl:e})}(Kl.exact(t,0,t,0))},Tf=function(n,t,e){return e.fold(S.none,S.none,(function(n,t){return Xo(t).map((function(n){return Sf(0,n)}))}),(function(e){return ie(e,t).bind((function(t){return n.execCommand("mceTableInsertRowAfter"),e=Tt(t,"tr"),V(e).bind((function(n){return Et(n,"td,th").map((function(n){return Sf(0,n)}))}));var e}))}))},Rf=["table","li","dl"],Df=function(n,t){return{selection:n,kill:t}},Of=function(n,t,e,r){return{start:Vl.on(n,t),finish:Vl.on(e,r)}},Af=function(n,t){var e=Zl(n,t);return Hl(Bn.fromDom(e.startContainer),e.startOffset,Bn.fromDom(e.endContainer),e.endOffset)},kf=Of,Bf=function(n,t,e,r,o){return In(e,r)?S.none():pr(e,r,t).bind((function(t){var r=t.boxes.getOr([]);return 0<r.length?(o(n,r,t.start,t.finish),S.some(Df(S.some(kf(e,0,e,Ko(e))),!0))):S.none()}))},Ef=function(n,t){return{item:n,mode:t}},Pf=function(n,t,e,r){return void 0===r&&(r=If),n.property().parent(t).map((function(n){return Ef(n,r)}))},If=function(n,t,e,r){return void 0===r&&(r=Mf),e.sibling(n,t).map((function(n){return Ef(n,r)}))},Mf=function(n,t,e,r){void 0===r&&(r=Mf);var o=n.property().children(t);return e.first(o).map((function(n){return Ef(n,r)}))},Nf=[{current:Pf,next:If,fallback:S.none()},{current:If,next:Mf,fallback:S.some(Pf)},{current:Mf,next:Mf,fallback:S.some(If)}],Wf=function(n,t,e,r,o){return void 0===o&&(o=Nf),N(o,(function(n){return n.current===e})).bind((function(e){return e.current(n,t,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return Wf(n,t,e,r)}))}))}))},Lf=function(n,t,e,r,o,u){return Wf(n,t,r,o).bind((function(t){return u(t.item)?S.none():e(t.item)?S.some(t.item):Lf(n,t.item,e,t.mode,o,u)}))},zf=function(n){return function(t){return 0===n.property().children(t).length}},_f=function(n,t,e,r){return Lf(n,t,e,If,{sibling:function(n,t){return n.query().prevSibling(t)},first:function(n){return 0<n.length?S.some(n[n.length-1]):S.none()}},r)},jf=function(n,t,e,r){return Lf(n,t,e,If,{sibling:function(n,t){return n.query().nextSibling(t)},first:function(n){return 0<n.length?S.some(n[0]):S.none()}},r)},Ff=or(),Hf=function(n,t){return _f(e=Ff,n,zf(e),t);var e},qf=function(n,t){return jf(e=Ff,n,zf(e),t);var e},Vf=yr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Uf=function(n){return Pt(n,"tr")},Kf=K(K({},Vf),{verify:function(n,t,e,r,o,u,i){return Pt(r,"td,th",i).bind((function(e){return Pt(t,"td,th",i).map((function(t){return In(e,t)?In(r,e)&&Ko(e)===o?u(t):Vf.none("in same cell"):dr(Uf,[e,t]).fold((function(){return o=t,i=e,c=(r=n).getRect(o),(a=r.getRect(i)).right>c.left&&a.left<c.right?Vf.success():u(t);var r,o,i,c,a}),(function(n){return u(t)}))}))})).getOr(Vf.none("default"))},cata:function(n,t,e,r,o){return n.fold(t,e,r,o)}}),$f=function(n){return"br"===Qn(n)},Gf=function(n,t,e){return t(n,e).bind((function(n){return rt(n)&&0===nr(n).trim().length?Gf(n,t,e):S.some(n)}))},Xf=function(n,t,e,r){return pt(o=t,u=e).filter($f).orThunk((function(){return pt(o,u-1).filter($f)})).bind((function(t){return r.traverse(t).fold((function(){return Gf(t,r.gather,n).map(r.relative)}),(function(n){return lt(t=n).bind((function(n){var e=mt(n);return function(n,t){return W(n,m(In,t))}(e,t).map((function(r){return{parent:n,children:e,element:t,index:r}}))})).map((function(n){return Vl.on(n.parent,n.index)}));var t}))}));var o,u},Yf=function(n,t){return{left:n.left,top:n.top+t,right:n.right,bottom:n.bottom+t}},Jf=function(n,t){return{left:n.left,top:n.top-t,right:n.right,bottom:n.bottom-t}},Qf=function(n,t,e){return{left:n.left+t,top:n.top+e,right:n.right+t,bottom:n.bottom+e}},Zf=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},ns=function(n,t){return S.some(n.getRect(t))},ts=function(n,t,e){return et(t)?ns(n,t).map(Zf):rt(t)?(r=n,o=t,(0<=(u=e)&&u<Ko(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):S.none()).map(Zf)):S.none();var r,o,u},es=function(n,t){return et(t)?ns(n,t).map(Zf):rt(t)?n.getRangedRect(t,0,t,Ko(t)).map(Zf):S.none()},rs=yr([{none:[]},{retry:["caret"]}]),os=function(n,t,e){return Rt((function(n,t){return t(n)}),At,t,aa,undefined).fold(b,(function(t){return es(n,t).exists((function(n){return r=n,(t=e).left<r.left||Math.abs(r.right-t.left)<1||t.left>r.right;var t,r}))}))},us={point:function(n){return n.bottom},adjuster:function(n,t,e,r,o){var u=Yf(o,5);return Math.abs(e.bottom-r.bottom)<1||e.top>o.bottom?rs.retry(u):e.top===o.bottom?rs.retry(Yf(o,1)):os(n,t,o)?rs.retry(Qf(u,5,0)):rs.none()},move:Yf,gather:qf},is=function(n,t,e,r,o){return 0===o?S.some(r):(a=n,l=r.left,f=t.point(r),a.elementFromPoint(l,f).filter((function(n){return"table"===Qn(n)})).isSome()?(i=r,c=o-1,is(n,u=t,e,u.move(i,5),c)):n.situsFromPoint(r.left,t.point(r)).bind((function(u){return u.start.fold(S.none,(function(u){return es(n,u).bind((function(i){return t.adjuster(n,u,i,e,r).fold(S.none,(function(r){return is(n,t,e,r,o-1)}))})).orThunk((function(){return S.some(r)}))}),S.none)})));var u,i,c,a,l,f},cs=function(n,t,e){var r,o,u,i=n.move(e,5),c=is(t,n,e,i,100).getOr(i);return o=c,u=t,((r=n).point(o)>u.getInnerHeight()?S.some(r.point(o)-u.getInnerHeight()):r.point(o)<0?S.some(-r.point(o)):S.none()).fold((function(){return t.situsFromPoint(c.left,n.point(c))}),(function(e){return t.scrollBy(0,e),t.situsFromPoint(c.left,n.point(c)-e)}))},as={tryUp:m(cs,{point:function(n){return n.top},adjuster:function(n,t,e,r,o){var u=Jf(o,5);return Math.abs(e.top-r.top)<1||e.bottom<o.top?rs.retry(u):e.bottom===o.top?rs.retry(Jf(o,1)):os(n,t,o)?rs.retry(Qf(u,5,0)):rs.none()},move:Jf,gather:Hf}),tryDown:m(cs,us),ieTryUp:function(n,t){return n.situsFromPoint(t.left,t.top-5)},ieTryDown:function(n,t){return n.situsFromPoint(t.left,t.bottom+5)},getJumpSize:s(5)},ls=function(n,t,e){return n.getSelection().bind((function(r){return function(n,t,e,r){var o,u,i;return($f(t)?(o=n,u=t,(i=r).traverse(u).orThunk((function(){return Gf(u,i.gather,o)})).map(i.relative)):Xf(n,t,e,r)).map((function(n){return{start:n,finish:n}}))}(t,r.finish,r.foffset,e).fold((function(){return S.some(ac(r.finish,r.foffset))}),(function(o){var u,i=n.fromSitus(o);return u=Kf.verify(n,r.finish,r.foffset,i.finish,i.foffset,e.failure,t),Kf.cata(u,(function(n){return S.none()}),(function(){return S.none()}),(function(n){return S.some(ac(n,0))}),(function(n){return S.some(ac(n,Ko(n)))}))}))}))},fs=function(n,t,e,r,o,u){return 0===u?S.none():ms(n,t,e,r,o).bind((function(i){var c=n.fromSitus(i),a=Kf.verify(n,e,r,c.finish,c.foffset,o.failure,t);return Kf.cata(a,(function(){return S.none()}),(function(){return S.some(i)}),(function(i){return In(e,i)&&0===r?ss(n,e,r,Jf,o):fs(n,t,i,0,o,u-1)}),(function(i){return In(e,i)&&r===Ko(i)?ss(n,e,r,Yf,o):fs(n,t,i,Ko(i),o,u-1)}))}))},ss=function(n,t,e,r,o){return ts(n,t,e).bind((function(t){return ds(n,o,r(t,as.getJumpSize()))}))},ds=function(n,t,e){var r=An().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(n,e):r.isIE()?t.ieRetry(n,e):S.none()},ms=function(n,t,e,r,o){return ts(n,e,r).bind((function(t){return ds(n,o,t)}))},ps=function(n,t,e,r,o){return Pt(r,"td,th",t).bind((function(r){return Pt(r,"table",t).bind((function(u){return function(n,t){return At(n,(function(n){return lt(n).exists((function(n){return In(n,t)}))}),void 0).isSome()}(o,u)?ls(i=n,c=t,a=e).bind((function(n){return fs(i,c,n.element,n.offset,a,20).map(i.fromSitus)})).bind((function(n){return Pt(n.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:n}}))})):S.none();var i,c,a}))}))},gs=function(n,t,e,r,o,u){return An().browser.isIE()?S.none():u(r,t).orThunk((function(){return ps(n,t,e,r,o).map((function(n){var t=n.range;return Df(S.some(kf(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},hs=function(n,t){return Pt(n,"tr",t).bind((function(n){return Pt(n,"table",t).bind((function(e){var r=Tt(e,"tr");return In(n,r[0])?_f(Ff,e,(function(n){return Yo(n).isSome()}),t).map((function(n){var t=Ko(n);return Df(S.some(kf(n,t,n,t)),!0)})):S.none()}))}))},vs=function(n,t){return Pt(n,"tr",t).bind((function(n){return Pt(n,"table",t).bind((function(e){var r=Tt(e,"tr");return In(n,r[r.length-1])?jf(Ff,e,(function(n){return Xo(n).isSome()}),t).map((function(n){return Df(S.some(kf(n,0,n,0)),!0)})):S.none()}))}))},bs=function(n,t,e,r,o,u,i){return ps(n,e,r,o,u).bind((function(n){return Bf(t,e,n.start,n.finish,i)}))},ws=function(n,t){return Pt(n,"td,th",t)},ys=function(n,t,e,r){var o,u=(o=_o(S.none()),{clear:function(){return o.set(S.none())},set:function(n){return o.set(S.some(n))},isSet:function(){return o.get().isSome()},on:function(n){return o.get().each(n)}}),i=u.clear,c=function(o){u.on((function(u){r.clearBeforeUpdate(t),ws(o.target,e).each((function(o){pr(u,o,e).each((function(e){var i=e.boxes.getOr([]);(1<i.length||1===i.length&&!In(u,o))&&(r.selectRange(t,i,e.start,e.finish),n.selectContents(o))}))}))}))};return{clearstate:i,mousedown:function(n){r.clear(t),ws(n.target,e).each(u.set)},mouseover:function(n){c(n)},mouseup:function(n){c(n),i()}}},xs={traverse:dt,gather:qf,relative:Vl.before,otherRetry:as.tryDown,ieRetry:as.ieTryDown,failure:Kf.failedDown},Cs={traverse:st,gather:Hf,relative:Vl.before,otherRetry:as.tryUp,ieRetry:as.ieTryUp,failure:Kf.failedUp},Ss=function(n){return function(t){return t===n}},Ts=Ss(38),Rs=Ss(40),Ds=function(n){return 37<=n&&n<=40},Os={isBackward:Ss(37),isForward:Ss(39)},As={isBackward:Ss(39),isForward:Ss(37)},ks=function(n){return{elementFromPoint:function(t,e){return Bn.fromPoint(Bn.fromDom(n.document),t,e)},getRect:function(n){return n.dom.getBoundingClientRect()},getRangedRect:function(t,e,r,o){var u=Kl.exact(t,e,r,o);return function(n,t){var e,r,o;return 0<(o=0<(r=(e=Zl(n,t)).getClientRects()).length?r[0]:e.getBoundingClientRect()).width||0<o.height?S.some(o).map(Xl):S.none()}(n,u)},getSelection:function(){return wf(n).map((function(t){return Af(n,t)}))},fromSitus:function(t){var e=Kl.relative(t.start,t.finish);return Af(n,e)},situsFromPoint:function(t,e){return function(n,t,e){return r=t,o=e,u=Bn.fromDom(n.document),cf(u,r,o).map((function(n){return Hl(Bn.fromDom(n.startContainer),n.startOffset,Bn.fromDom(n.endContainer),n.endOffset)}));var r,o,u}(n,t,e).map((function(n){return Of(n.start,n.soffset,n.finish,n.foffset)}))},clearSelection:function(){sf(n).each((function(n){return n.removeAllRanges()}))},collapseSelection:function(t){void 0===t&&(t=!1),wf(n).each((function(e){return e.fold((function(n){return n.collapse(t)}),(function(e,r){var o=t?e:r;hf(n,o,o)}),(function(e,r,o,u){var i=t?e:o,c=t?r:u;gf(n,i,c,i,c)}))}))},setSelection:function(t){gf(n,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,e){hf(n,t,e)},selectContents:function(t){!function(n,t){var e,r,o=(e=t,function(n,t){n.selectNodeContents(t.dom)}(r=n.document.createRange(),e),r);df(n,o)}(n,t)},getInnerHeight:function(){return n.innerHeight},getScrollY:function(){var t,e,r,o;return(t=Bn.fromDom(n.document),e=void 0!==t?t.dom:document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop,Ur(r,o)).top},scrollBy:function(t,e){var r,o,u,i;r=t,o=e,(i=(void 0!==(u=Bn.fromDom(n.document))?u.dom:document).defaultView)&&i.scrollBy(r,o)}}},Bs=function(n,t){return{rows:n,cols:t}},Es=function(n){return!1===si(Bn.fromDom(n.target),"ephox-snooker-resizer-bar")};function Ps(n,t,e){var r=function(n,t,e){var r=function(t){zt(t,n.selected),zt(t,n.firstSelected),zt(t,n.lastSelected)},o=function(t){Mt(t,n.selected,"1")},u=function(n){i(n),e()},i=function(t){var e=Tt(t,n.selectedSelector);E(e,r)};return{clearBeforeUpdate:i,clear:u,selectRange:function(e,r,i,c){u(e),E(r,o),Mt(i,n.firstSelected,"1"),Mt(c,n.lastSelected,"1"),t(r,i,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}}(wu,(function(t,r,o){e.targets().each((function(e){ie(r).each((function(u){var i,c,a,l,s=Zi(n),d=uu(f,Bn.fromDom(n.getDoc()),s),m=function(n,t,e){var r=Oe(n);return Oc(r,t).map((function(n){var t,o,u,i,c,a,l,f,s,d=yc(r,e,!1);return{upOrLeftCells:(t=n,o=e,u=d.slice(0,t[t.length-1].row+1),i=xc(u,o),z(i,(function(n){var e=n.cells.slice(0,t[t.length-1].column+1);return B(e,(function(n){return n.element}))}))),downOrRightCells:(a=n,l=e,f=(c=d).slice(a[0].row+a[0].rowspan-1,c.length),s=xc(f,l),z(s,(function(n){var t=n.cells.slice(a[0].column+a[0].colspan-1,n.cells.length);return B(t,(function(n){return n.element}))})))}}))}(u,e,d);i=t,c=r,a=o,l=m,n.fire("TableSelectionChange",{cells:i,start:c,finish:a,otherCells:l})}))}))}),(function(){n.fire("TableSelectionClear")}));return n.on("init",(function(e){var o,u,i,c,a,l,s=n.getWin(),d=lu(n),p=du(n),g=(o=ks(s),{clearstate:(u=ys(o,d,p,r)).clearstate,mousedown:u.mousedown,mouseover:u.mouseover,mouseup:u.mouseup}),h=function(n,t,e,r){var o=ks(n),u=function(){return r.clear(t),S.none()};return{keydown:function(n,i,c,a,l,f){var s=n.raw,d=s.which,p=!0===s.shiftKey;return gr(t,r.selectedSelector).fold((function(){return Rs(d)&&p?m(bs,o,t,e,xs,a,i,r.selectRange):Ts(d)&&p?m(bs,o,t,e,Cs,a,i,r.selectRange):Rs(d)?m(gs,o,e,xs,a,i,vs):Ts(d)?m(gs,o,e,Cs,a,i,hs):S.none}),(function(n){var e=function(e){return function(){return U(e,(function(e){return o=e.rows,u=e.cols,i=t,vr(n,o,u,(c=r).firstSelectedSelector,c.lastSelectedSelector).map((function(n){return c.clearBeforeUpdate(i),c.selectRange(i,n.boxes,n.start,n.finish),n.boxes}));var o,u,i,c})).fold((function(){return hr(t,r.firstSelectedSelector,r.lastSelectedSelector).map((function(n){var e=Rs(d)||f.isForward(d)?Vl.after:Vl.before;return o.setRelativeSelection(Vl.on(n.first,0),e(n.table)),r.clear(t),Df(S.none(),!0)}))}),(function(n){return S.some(Df(S.none(),!0))}))}};return Rs(d)&&p?e([Bs(1,0)]):Ts(d)&&p?e([Bs(-1,0)]):f.isBackward(d)&&p?e([Bs(0,-1),Bs(-1,0)]):f.isForward(d)&&p?e([Bs(0,1),Bs(1,0)]):Ds(d)&&0==p?u:S.none}))()},keyup:function(n,o,u,i,c){return gr(t,r.selectedSelector).fold((function(){var a,l,f,s,d,m,p,g=n.raw,h=g.which;return 0!=(!0===g.shiftKey)&&Ds(h)?(a=t,l=e,f=o,s=u,d=i,m=c,p=r.selectRange,In(f,d)&&s===m?S.none():Pt(f,"td,th",l).bind((function(n){return Pt(d,"td,th",l).bind((function(t){return Bf(a,l,n,t,p)}))}))):S.none()}),S.none)}}}(s,d,p,r),v=(i=d,c=p,a=r,l=ks(s),function(n,t){a.clearBeforeUpdate(i),pr(n,t,c).each((function(n){var e=n.boxes.getOr([]);a.selectRange(i,e,n.start,n.finish),l.selectContents(t),l.collapseSelection()}))});n.on("TableSelectorChange",(function(n){return v(n.start,n.finish)}));var b,w,y=function(t,e){!0===t.raw.shiftKey&&(e.kill&&t.kill(),e.selection.each((function(t){var e=Kl.relative(t.start,t.finish),r=Zl(s,e);n.selection.setRng(r)})))},x=function(n){return 0===n.button},C=(b=_o(Bn.fromDom(d)),w=_o(0),{touchEnd:function(n){var t,e,r=Bn.fromDom(n.target);"td"!==Qn(r)&&"th"!==Qn(r)||(t=b.get(),e=w.get(),In(t,r)&&n.timeStamp-e<300&&(n.preventDefault(),v(r,r))),b.set(r),w.set(n.timeStamp)}});n.on("dragstart",(function(n){g.clearstate()})),n.on("mousedown",(function(n){x(n)&&Es(n)&&g.mousedown(ci(n))})),n.on("mouseover",(function(n){var t;(void 0===(t=n).buttons||El.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&Es(n)&&g.mouseover(ci(n))})),n.on("mouseup",(function(n){x(n)&&Es(n)&&g.mouseup(ci(n))})),n.on("touchend",C.touchEnd),n.on("keyup",(function(t){var e,r,o,u=ci(t);u.raw.shiftKey&&Ds(u.raw.which)&&(e=n.selection.getRng(),r=Bn.fromDom(e.startContainer),o=Bn.fromDom(e.endContainer),h.keyup(u,r,e.startOffset,o,e.endOffset).each((function(n){y(u,n)})))})),n.on("keydown",(function(e){var r=ci(e);t().each((function(n){return n.hideBars()}));var o=n.selection.getRng(),u=Bn.fromDom(o.startContainer),i=Bn.fromDom(o.endContainer),c=_r(Os,As)(Bn.fromDom(n.selection.getStart()));h.keydown(r,u,o.startOffset,i,o.endOffset,c).each((function(n){y(r,n)})),t().each((function(n){return n.showBars()}))})),n.on("NodeChange",(function(){var t=n.selection,e=Bn.fromDom(t.getStart()),o=Bn.fromDom(t.getEnd());dr(ie,[e,o]).fold((function(){return r.clear(d)}),f)}))})),{clear:r.clear}}Dr.add("table",(function(n){var t,e,r,o,u,i,c,a,l=(t=function(){return lu(n)},e=function(){return Ja(vu(n))},r=wu.selectedSelector,{get:function(){return br(t(),r).fold((function(){return e().map(Rr).getOrThunk(Sr)}),(function(n){return Tr(n)}))}}),s=function(n,t){var e=_o(S.none()),r=_o([]),o=S.none(),u=it("caption"),i=function(n){return o.forall((function(t){return!t[n]}))},c=function(){return Ja(vu(n),du(n)).bind((function(n){return ie(n).map((function(e){return u(n)?{element:r=n,mergable:S.none(),unmergable:S.none(),selection:[r]}:yu(t,e,n);var r}))}))},a=function(n){return ie(n.element).map((function(t){var e=Oe(t),r=Oc(e,n).getOr([]),o=M(r,(function(n,t){return t.isLocked&&(n.onAny=!0,0===t.column?n.onFirst=!0:t.column+t.colspan>=e.grid.columns&&(n.onLast=!0)),n}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Ec(e,n).isSome(),unmergeable:Pc(e,n).isSome(),locked:o}}))},l=function(){e.set(X(c)()),o=e.get().bind(a),E(r.get(),(function(n){return n()}))},f=function(n,t){var o=function(){return e.get().fold((function(){n.setDisabled(!0)}),(function(e){n.setDisabled(t(e))}))};return o(),r.set(r.get().concat([o])),function(){r.set(P(r.get(),(function(n){return n!==o})))}},s=function(n){return o.exists((function(t){return t.locked[n]}))};return n.on("NodeChange ExecCommand TableSelectorChange",l),{onSetupTable:function(n){return f(n,(function(n){return!1}))},onSetupCellOrRow:function(n){return f(n,(function(n){return u(n.element)}))},onSetupColumn:function(n){return function(t){return f(t,(function(t){return u(t.element)||s(n)}))}},onSetupPasteable:function(n){return function(t){return f(t,(function(t){return u(t.element)||n().isNone()}))}},onSetupPasteableColumn:function(n,t){return function(e){return f(e,(function(e){return u(e.element)||n().isNone()||s(t)}))}},onSetupMergeable:function(n){return f(n,(function(n){return i("mergeable")}))},onSetupUnmergeable:function(n){return f(n,(function(n){return i("unmergeable")}))},resetTargets:l,targets:function(){return e.get()}}}(n,l),d=cc(n),m=Ps(n,d.lazyResize,s),p=function(n,t,e){var r=function(n){return"table"===Qn(lu(n))},o=Zi(n),u=Qi(n)?f:pc,i=function(t,e,r,u,i){return function(c,a){pu(c);var l=u(),f=Bn.fromDom(n.getDoc()),s=uu(r,f,o),d=nc(n,c),m=(Qi(n)?Eu:Pu)();return e(c)?t(l,c,a,s,d,m).bind((function(t){return E(t.newRows,(function(t){Bi(n,t.dom)})),E(t.newCells,(function(t){Ei(n,t.dom)})),t.cursor.map((function(t){var e=dc(mc,t),r=n.dom.createRng();return r.setStart(e.element.dom,e.offset),r.setEnd(e.element.dom,e.offset),{rng:r,effect:i}}))})):S.none()}},c=i(Ea,(function(t){return!1===r(n)||1<$u(t).rows}),f,t,Mi),a=i(Ba,(function(t){return!1===r(n)||1<$u(t).columns}),f,t,Mi),l=i(Da,w,f,t,Mi),s=i(Oa,w,f,t,Mi),d=i(Aa,w,u,t,Mi),m=i(ka,w,u,t,Mi),p=i(Ma,w,f,t,Mi),g=i(Na,w,f,t,Mi),h=i(La,w,f,t,Mi),v=i(za,w,f,t,Mi),b=i(_a,w,f,t,Mi),y=i(ja,w,f,t,Mi),x=i(Wa,w,f,t,Mi),C=function(n,t){return Vn(n,"type").filter((function(n){return O(t,n)}))};return{deleteRow:c,deleteColumn:a,insertRowsBefore:l,insertRowsAfter:s,insertColumnsBefore:d,insertColumnsAfter:m,mergeCells:p,unmergeCells:g,pasteColsBefore:h,pasteColsAfter:v,pasteRowsBefore:b,pasteRowsAfter:y,pasteCells:x,setTableCellType:function(n,t){return C(t,["td","th"]).each((function(t){var r=B(Qa(vu(n),e),(function(n){return n.dom}));$a(n,r,t,null)}))},setTableRowType:function(n,t){return C(t,["header","body","footer"]).each((function(t){B(Za(vu(n),wu.selected),(function(e){return Ga(n,e.dom,t)}))}))},makeColumnsHeader:i(Pa,w,f,t,Mi),unmakeColumnsHeader:i(Ia,w,f,t,Mi),getTableRowType:function(n){var t=Za(vu(n),wu.selected);if(0<t.length){var e=B(t,(function(n){return Va(0,n.dom)})),r=O(e,"header"),o=O(e,"footer");if(r||o){var u=O(e,"body");return!r||u||o?r||u||!o?"":"footer":"header"}return"body"}},getTableCellType:function(n){return ba(Qa(vu(n),e),(function(n){return"th"===Qn(n)})).getOr("")},getTableColType:Fa}}(n,d.lazyWire,l),g=(o=_o(S.none()),u=_o(S.none()),i=function(n){n.set(S.none())},{getRows:o.get,setRows:function(n){o.set(n),i(u)},clearRows:function(){return i(o)},getColumns:u.get,setColumns:function(n){u.set(n),i(o)},clearColumns:function(){return i(u)}});return Ll(n,p,m,l,g),function(n,t,e){var r=du(n);zn({mceTableRowType:function(){return t.getTableRowType(n)},mceTableCellType:function(){return t.getTableCellType(n)},mceTableColType:function(){return Ya(vu(n)).bind((function(n){return ie(n,r).map((function(r){var o=yu(e,r,n);return t.getTableColType(r,o)}))})).getOr("")}},(function(t,e){return n.addQueryValueHandler(e,t)}))}(n,p,l),function(n,t,e,r){n.on("BeforeGetContent",(function(e){!0===e.selection&&Cr(t.get(),f,(function(t){e.preventDefault(),ie(t[0]).map((function(n){var t=Uo(n,"[data-mce-selected]");return pu(t),[t]})).each((function(t){var r;e.content="text"===e.format?B(t,(function(n){return n.dom.innerText})).join(""):(r=n,B(t,(function(n){return r.selection.serializer.serialize(n.dom,{})})).join(""))}))}),f)})),n.on("BeforeSetContent",(function(t){!0===t.selection&&!0===t.paste&&S.from(n.dom.getParent(n.selection.getStart(),"th,td")).each((function(o){var u=Bn.fromDom(o);ie(u).each((function(o){var i,c,a,l,f,s,d=P((i=t.content,(c=document.createElement("div")).innerHTML=i,mt(Bn.fromDom(c))),(function(n){return"meta"!==Qn(n)}));1===d.length&&(s=d[0],"table"===Qn(s))&&(t.preventDefault(),a=Bn.fromDom(n.getDoc()),l=iu(a),f={element:u,clipboard:d[0],generators:l},e.pasteCells(o,f).each((function(t){n.selection.setRng(t.rng),n.focus(),r.clear(o)})))}))}))}))}(n,l,p,m),function(n,t,e){var r=function(t){return function(){return n.execCommand(t)}},o=function(t){n.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},u={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};n.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),n.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),n.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onFirst")}),n.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onLast")}),n.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),n.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}),!1===n.getParam("table_grid",!0,"boolean")?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",u),n.ui.registry.addMenuItem("deletetable",i),n.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),n.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),n.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),n.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(n){return"caption"===Qn(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(n,s,g),function(n,t,e){n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return n.execCommand(t)}};n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onFirst")}),n.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onLast")}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(n,s,g),0<(a=(c=n).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&c.ui.registry.addContextToolbar("table",{predicate:function(n){return c.dom.is(n,"table")&&c.getBody().contains(n)},items:a,scope:"node",position:"node"}),n.on("PreInit",(function(){n.serializer.addTempAttr(wu.firstSelected),n.serializer.addTempAttr(wu.lastSelected),n.formatter.register(zl)})),n.getParam("table_tab_navigation",!0,"boolean")&&n.on("keydown",(function(t){var e,r,o,u,i,c,a;r=n,o=m,(e=t).keyCode===yf.TAB&&(u=lu(r),i=function(n){var t=Qn(n);return In(n,u)||O(Rf,t)},c=r.selection.getRng(),a=Bn.fromDom(e.shiftKey?c.startContainer:c.endContainer),re(a,i).each((function(n){e.preventDefault(),ie(n,i).each(o.clear),r.selection.collapse(e.shiftKey),(e.shiftKey?Cf:xf)(r,i,n).each((function(n){r.selection.setRng(n)}))})))})),n.on("remove",(function(){d.destroy()})),function(n,t,e,r){return{insertTable:(o=n,function(n,t,e){void 0===e&&(e={});var r=ol(o,t,n,e,"Invalid values for insertTable - rows and columns values are required to insert a table.");return o.undoManager.add(),r}),setClipboardRows:il(t.setRows),getClipboardRows:ul(t.getRows),setClipboardCols:il(t.setColumns),getClipboardCols:ul(t.getColumns),resizeHandler:e,selectionTargets:r};var o}(n,g,d,s)}))}();