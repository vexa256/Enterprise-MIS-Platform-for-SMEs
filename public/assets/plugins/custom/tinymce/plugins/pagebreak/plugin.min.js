!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.Env"),n=function(e){return e.getParam("pagebreak_split_block",!1)},t="mce-pagebreak",r=function(e){var n='<img src="'+a.transparentSrc+'" class="'+t+'" data-mce-resize="false" data-mce-placeholder />';return e?"<p>"+n+"</p>":n};e.add("pagebreak",(function(e){var a,o,c,i,g,u,m;(a=e).addCommand("mcePageBreak",(function(){a.insertContent(r(n(a)))})),(o=e).ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:function(){return o.execCommand("mcePageBreak")}}),o.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:function(){return o.execCommand("mcePageBreak")}}),i=(c=e).getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e"),g=function(){return n(c)},u=new RegExp(i.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,(function(e){return"\\"+e})),"gi"),c.on("BeforeSetContent",(function(e){e.content=e.content.replace(u,r(g()))})),c.on("PreInit",(function(){c.serializer.addNodeFilter("img",(function(e){for(var a,n,r=e.length;r--;)if((n=(a=e[r]).attr("class"))&&-1!==n.indexOf(t)){var o=a.parent;if(c.schema.getBlockElements()[o.name]&&g()){o.type=3,o.value=i,o.raw=!0,a.remove();continue}a.type=3,a.value=i,a.raw=!0}}))})),(m=e).on("ResolveName",(function(e){"IMG"===e.target.nodeName&&m.dom.hasClass(e.target,t)&&(e.name="pagebreak")}))}))}();